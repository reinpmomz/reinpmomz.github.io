---
title: "S_I_R V3 18.09.2021"
author: "Elvis Kirui"
date: "`r Sys.Date()`"
output:
  word_document: 
    fig_width: 9
    fig_height: 6
  pdf_document: default
  html_document: 
    keep_md: yes
---

# R Programming

```{r setup, include=FALSE}
## Set Chunk requirements
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

```

## loading Relevant packages and Data Set

```{r Import relevant packages}
#Import relevant packages

## tidyverse includes readr, ggplot2, dplyr, forcats, tibble, tidyr, purrr, stringr
library(tidyverse) 
library(readxl)
library(janitor)
library(lubridate)
library(plotly)
library(knitr)

## loading the csv data set

setwd('F:\\Documents\\ElvisKip\\Sir_Models 06.08.2021')

#setwd('C:/Users/atele/Desktop/Reinp/ElvisKip/SIR')

S_I_R_V3 <- read_excel("S_I_R V3.xlsx", sheet = "Sheet1")%>%
  clean_names()%>%
  select(1:22)


View(S_I_R_V3)


```



## Clean Data


```{r}
counties <- S_I_R_V3%>%
  select(4)%>%
  mutate(across(c(1), str_to_upper))%>%
  mutate(county_where_the_case_was_diagonised =
           ifelse(county_where_the_case_was_diagonised == "MALAWI", "NAIROBI",                                             county_where_the_case_was_diagonised))%>%
  drop_na()%>%
  unique()



S_I_R_V3_r <- S_I_R_V3%>%
  mutate(across(c(3:12,18,20), str_to_upper))%>%
  mutate(age_years = ifelse(age_years > 110, NA, age_years))%>%
  mutate(sex = ifelse(sex == "Y", NA, sex))%>%
  mutate(date_of_lab_confirmation = ymd(date_of_lab_confirmation))%>%
  mutate(county_where_the_case_was_diagonised =
           ifelse(county_where_the_case_was_diagonised == "MALAWI", "NAIROBI",                                             county_where_the_case_was_diagonised))%>%
  mutate(symptoms_yes_no = ifelse(symptoms_yes_no == "Y", "YES",
              ifelse(symptoms_yes_no == "N", "NO", symptoms_yes_no)))%>%
  mutate(classification_meet_case_definition_do_not_meet_case_definition =
           ifelse(classification_meet_case_definition_do_not_meet_case_definition == "Y", "YES",
            ifelse(classification_meet_case_definition_do_not_meet_case_definition == "N", "NO",
         ifelse(classification_meet_case_definition_do_not_meet_case_definition == "ASYMPTOMATIC",
                "ASYMPTOMATIC", 
         ifelse(classification_meet_case_definition_do_not_meet_case_definition == "43991",
               NA, classification_meet_case_definition_do_not_meet_case_definition)))))%>%
  mutate(cough = 
    ifelse(cough == "Y"| cough == "YE"| cough == "YERS" | cough == "YES" , "YES",
    ifelse(cough == "N"| cough == "NONE" | cough == "NO" , "NO", NA)))%>%
  mutate(fever = if_else(fever == "FEVER" , "YES",
      if_else(fever == "N"| fever == "NONE"| fever == "NIO" , "NO", fever)))%>%
  mutate(difficulty_in_breathing = 
           if_else(difficulty_in_breathing == "DIB" |
                     difficulty_in_breathing == "TES" , "YES",
        if_else(difficulty_in_breathing == "N"| difficulty_in_breathing == "NIL"|
                          difficulty_in_breathing == "N0" , "NO",
              ifelse(difficulty_in_breathing == "CHESTPAIN" | difficulty_in_breathing == "NP" , NA,difficulty_in_breathing))))%>%
  mutate(travel_history_last_14_days =
           if_else(travel_history_last_14_days == "Y"|
               travel_history_last_14_days == "YES"|      
            travel_history_last_14_days == "YES TO NAIROBI"|
              str_detect(travel_history_last_14_days, "FROM")|
              travel_history_last_14_days == "CHANGAMWE"|
              travel_history_last_14_days == "ELDORET"|
              travel_history_last_14_days == "MOMBASA"|
              travel_history_last_14_days == "NAKURU"|
              travel_history_last_14_days == "NYERI"|
              str_detect(travel_history_last_14_days, "INDIA")|
              str_detect(travel_history_last_14_days, "UGANDA"), "YES",
      ifelse(travel_history_last_14_days == "N"|
                travel_history_last_14_days == "NO"|
                travel_history_last_14_days == "NONE"|
                travel_history_last_14_days == "NULL"|
                travel_history_last_14_days == "NO HISTORY"|
                travel_history_last_14_days == "FALSE"|
                travel_history_last_14_days == "N0", "NO",
              NA)))%>%
  mutate(nationality = if_else(str_detect(nationality, "ZIMB"), "ZIMBABWE",
              if_else(str_detect(nationality, "KENYA")|
      str_detect(nationality, paste(c(unique(counties$county_where_the_case_was_diagonised)), collapse = "|")),
      "KENYA",
      if_else(str_detect(nationality, "AFGHAN"), "AFGHANISTAN",
          if_else(nationality == "AMERICAN"| nationality == "USA",
                  "UNITED STATES OF AMERICA",
        if_else(nationality == "AUSRALIAN"| nationality == "AUSTRALIA"|
                 nationality == "AUSTRARIAN", "AUSTRALIAN",
        if_else(nationality == "BRITAIN"| nationality == "BRITISH"|
               nationality == "BRITON"| nationality == "LONDON" , "UK",
        if_else(nationality == "BURKINABE", "BURKINA FASO",
  if_else(nationality == "BURUNDIAN"| nationality == "BRURUNDIAN", "BURUNDI",
      if_else(str_detect(nationality, "CAMEROON")|
                nationality == "CAMROONIAN", "CAMEROON",
    if_else(nationality == "CADIAN"| nationality == "CANDIAN"|
          nationality == "CANADAIAN"| nationality == "CANADIAN" , "CANADA",
        if_else(str_detect(nationality, "CHADIA"), "CHAD",
    if_else(nationality == "CENRAL AFRICAN"|
          nationality == "CENTRAL AFRICAN", "CENTRAL AFRICAN REPUBLIC",
          if_else(nationality == "CHINESE", "CHINA",
    if_else(nationality == "URUGUAYAN"| nationality == "URUGUYIAN", "URUGUAY",   
    if_else(nationality == "UKRAIN"| nationality == "UKRAINIAN"|
               nationality == "UKRANIAN" , "UKRAINE",
     if_else(str_detect(nationality, "UGANDA"), "UGANDA",
         if_else(str_detect(nationality, "YEMEN"), "YEMEN",
             if_else(str_detect(nationality, "TUNIS"), "TUNISIA",
    if_else(nationality == "THAI", "THAILAND",
  if_else(nationality == "TRINIADADIAN"| nationality == "TRINIDADIAN", "TRINIDAD",
   if_else(nationality == "TANXANIAN"| nationality == "TANZANIAN", "TANZANIA",
  if_else(nationality == "ASWISS"| nationality == "SWISS", "SWITZERLAND",
  if_else(nationality == "SWDISH"| nationality == "SWEDISH", "SWEDEN",
   if_else(nationality == "SUDANESE"| nationality == "SUDANESSE", "SUDAN",
  if_else(nationality == "SOUTH SUDANASE"|
            nationality == "SOUTH SUDANESE", "SOUTH SUDAN",
  if_else(nationality == "SRI LANAKAN"| nationality == "SIRI LANKAN"|
            nationality == "SRI LANKAN", "SRI LANKA",
    if_else(nationality == "SOTH AFRICAN"|
            nationality == "SOUTH AFRICAN", "SOUTH AFRICA",
    if_else(str_detect(nationality, "SOMALI"), "SOMALIA",
    if_else(nationality == "SIERRA LEONEAN"| nationality == "SIERRA LEONIAN"|
               nationality == "SIERRA LEONNE"|
              nationality == "SUIERRA LEONNE", "SIERRA LEONE", 
    if_else(str_detect(nationality, "RWAND")| nationality == "RWADESE",
            "RWANDA",
    if_else(str_detect(nationality, "ROMANIA"), "ROMANIA",
    if_else(str_detect(nationality, "PORTUG"), "PORTUGAL",
      if_else(nationality == "PRUVIAN"|nationality == "PERUVIAN", "PERU",
    if_else(nationality == "PHILLIPINO"| nationality == "FILIPINO"|
            nationality == "FILIPO"| nationality == "FILLIPINO",
            "PHILIPPINES",
    if_else(nationality == "PAKISTANI"|nationality == "PAKSITANI"|
             nationality == "PAKSTANI" , "PAKISTAN",
                                nationality 
        ))))))))))))))))))))))))))))))))))))


S_I_R_V3_final <- S_I_R_V3_r%>%
  mutate(nationality = if_else(str_detect(nationality, "NIGERI"), "NIGERIA",
      if_else(str_detect(nationality, "NEW ZE"), "NEW ZEALAND",
              if_else(nationality == "NI-VANUATU", "VANUATU",
      if_else(nationality == "MOZABICAN", "MOZAMBICAN",
      if_else(nationality == "MOTSWANA", "BOTSWANA",
      if_else(nationality == "MOSOTHO", "LESOTHO",
    if_else(nationality == "MEXICAN"| nationality == "MERXICAN", "MEXICO",
    if_else(str_detect(nationality, "MALAWI"), "MALAWI",
    if_else(str_detect(nationality, "KUWAIT"), "KUWAIT",
    if_else(nationality == "MALASYIAN"| nationality == "MALAYSIAN"|
      nationality == "MALYSIAN"| nationality == "MARASIA","MALAYSIA",
     if_else(nationality == "LITHUNIAN", "LITHUANIAN",
    if_else(nationality == "LABANESE"| nationality == "LEBENESE", "LEBANESE",
    if_else(nationality == "KITTITIAN", "SAINT KITTS AND NEVIS",
    if_else(nationality == "KOREAN", "SOUTH KOREAN",
    if_else(str_detect(nationality, "KAZAKH"), "KAZAKHSTAN",
    if_else(str_detect(nationality, "JAPAN"), "JAPAN",
     if_else(str_detect(nationality, "ITALY"), "ITALIAN",
    if_else(nationality == "ISRAEL"| nationality == "ISREAL", "ISRAELI",
    if_else(nationality == "IRARIAN", "IRANIAN",
    if_else(nationality == "INDIIAN"| nationality == "INDIA"|
              nationality == "ASIAN", "INDIAN",
    if_else(str_detect(nationality, "BANGLADESH")|nationality == "BENGALI" ,
            "BANGLADESH",
        if_else(nationality == "BELGIAN", "BELGIUM",
        if_else(str_detect(nationality, "BRAZIL"), "BRAZIL",
        if_else(str_detect(nationality, "KIRIBATI"), "KIRIBATI",
  if_else(nationality == "GHANANIAN"| nationality == "GHANIAN", "GHANAIAN",
  if_else(nationality == "GERAMAN"| nationality == "GERMANY", "GERMAN",
  if_else(str_detect(nationality, "ETHIO")| nationality == "ETHIPIAN", "ETHIOPIA",
  if_else(str_detect(nationality, "ERITREA")| nationality == "ERITERIAN" |
          nationality == "ERTREAN" , "ERITREAN",
  if_else(nationality == "EMARATI"| nationality == "EMIRATI", "U.A.E",
  if_else(str_detect(nationality, "DJIBOUTI")| nationality == "EMARATI",
          "DJBOUTIAN",
      if_else(nationality == "CHZEN", "CZECH",
       if_else(str_detect(nationality, "COMOR"), "COMOROS",
                                nationality )))))))))))))))))))))))))))))))))%>%
  mutate(lab_results = ifelse(str_detect(lab_results, "POSIT")| 
                        lab_results == "POSTIVE", "POSITIVE",
                              NA))%>%
  mutate(outcome_death_discharge_still_in_hospital =
        ifelse(outcome_death_discharge_still_in_hospital == "44303", NA,
                  outcome_death_discharge_still_in_hospital))%>%
  mutate(recovered = 
      if_else(outcome_death_discharge_still_in_hospital == "DEAD"|
      outcome_death_discharge_still_in_hospital == "STILL IN HOSPITAL","NO",
      "YES"))%>%
  replace_na(list(recovered = "YES"))




```



## SIR MODEL


```{r}
#Load required libraries
library(deSolve)
library(reshape2)


date_cases <- tibble(date = c(seq(min(S_I_R_V3_final$date_of_lab_confirmation), max(S_I_R_V3_final$date_of_lab_confirmation), by=1)))%>%
  mutate(status = c( rep("Total Lockdown",length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))),
                     rep("Partially opening",length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))),
                     rep("Reopening",length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1)))))%>%
  mutate(date = ymd(date) )%>%
  mutate(month_year_date = floor_date(date, unit = "month"))


Pop_county <- read_excel("V1_T2.2.xlsx", sheet = "Sheet 1")%>%
  clean_names()%>%
  slice(2:48)


```



```{r}

 cases_date_county_all <- do.call("rbind",
                                  replicate(47, date_cases, simplify = FALSE))%>%
  mutate(county = rep(c(unique(counties$county_where_the_case_was_diagonised)),
                         each = 430, times = 1))%>%
  mutate(date= ymd(date))%>%
  left_join(S_I_R_V3_final%>%
  filter(lab_results == "POSITIVE")%>%
  select(4, 19, 18)%>%
  group_by(county_where_the_case_was_diagonised, date_of_lab_confirmation)%>%
  summarise(cases = length(lab_results), .groups = "drop"),
  by = c("date" = "date_of_lab_confirmation", 
         "county" = "county_where_the_case_was_diagonised"))%>%
  replace_na(list(cases = 0))

sum(cases_date_county_all$cases)

```



### Parameter Estimation (one-parameter optimization)

one-dimensional optimization by Nelder-Mead is unreliable: use “Brent” or optimize() directly


```{r}

SIR <- function(time, state, parameters) {
  par <- as.list(c(state, parameters))
  with(par, {
    N=S+I+R
    gamma=1/14
    dS <- - (beta/N) * I * S
    dI <- beta/N * I * S - gamma * I
    dR <- gamma * I
    list(c(dS, dI, dR))
  })
}

```


#### All Ages Per County

```{r}

cases_date_county_all_wide <- cases_date_county_all %>%
  pivot_wider(names_from = county, values_from = cases, values_fill = 0)

df <- cases_date_county_all_wide%>%select(1, 4:50)

df1 <- df%>%
  filter(date <= as.Date("2020/03/31"))

df2 <- cases_date_county_all_wide%>%
  filter(status == "Total Lockdown")%>%
  select(1, 4:50)

df3 <- cases_date_county_all_wide%>%
  filter(status == "Partially opening")%>%
  select(1, 4:50)

df4 <- cases_date_county_all_wide%>%
  filter(status == "Reopening")%>%
  select(1, 4:50)


```


```{r, include= FALSE}

#As at march 2020 - May 2021


RSS_county1_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kajiado"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KAJIADO - fit)^2)
}


RSS_county2_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nairobi City"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$NAIROBI - fit)^2)
}

RSS_county3_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kwale"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KWALE - fit)^2)
}

RSS_county4_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kilifi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KILIFI - fit)^2)
}
 
RSS_county5_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mombasa"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$MOMBASA - fit)^2)
}

RSS_county6_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kakamega"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KAKAMEGA - fit)^2)
}


RSS_county7_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kitui"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KITUI - fit)^2)
}


RSS_county8_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nakuru"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$NAKURU - fit)^2)
}


RSS_county9_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mandera"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$MANDERA - fit)^2)
}


RSS_county10_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Uasin Gishu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`UASIN GISHU` - fit)^2)
}

RSS_county11_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Siaya"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$SIAYA - fit)^2)
}


RSS_county12_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Homa Bay"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`HOMA BAY` - fit)^2)
}

RSS_county13_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kiambu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KIAMBU - fit)^2)
}

RSS_county14_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Wajir"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$WAJIR - fit)^2)
}
 
RSS_county15_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Migori"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$MIGORI - fit)^2)
}

RSS_county16_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bungoma"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$BUNGOMA - fit)^2)
}


RSS_county17_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Busia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$BUSIA - fit)^2)
}


RSS_county18_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Isiolo"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$ISIOLO - fit)^2)
}


RSS_county19_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Machakos"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$MACHAKOS - fit)^2)
}


RSS_county20_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bomet"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$BOMET - fit)^2)
    
}


RSS_county21_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Taita/Taveta"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`TAITA TAVETA` - fit)^2)
}


RSS_county22_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Garissa"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$GARISSA - fit)^2)
}

RSS_county23_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Makueni"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$MAKUENI - fit)^2)
}

RSS_county24_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisii"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KISII - fit)^2)
}
 
RSS_county25_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Meru"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$MERU - fit)^2)
}

RSS_county26_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kirinyaga"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KIRINYAGA - fit)^2)
}


RSS_county27_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Trans Nzoia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`TRANS NZOIA` - fit)^2)
}


RSS_county28_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisumu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KISUMU - fit)^2)
}


RSS_county29_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Turkana"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$TURKANA - fit)^2)
}


RSS_county30_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Embu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$EMBU - fit)^2)
}


RSS_county31_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyeri"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$NYERI - fit)^2)
}


RSS_county32_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Murang'a"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`MURANG'A` - fit)^2)
}

RSS_county33_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kericho"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$KERICHO - fit)^2)
}

RSS_county34_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Laikipia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$LAIKIPIA - fit)^2)
}
 
RSS_county35_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nandi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$NANDI - fit)^2)
}

RSS_county36_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Elgeyo/Marakwet"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`ELGEYO MARAKWET` - fit)^2)
}


RSS_county37_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Marsabit"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$MARSABIT - fit)^2)
}


RSS_county38_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Narok"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$NAROK - fit)^2)
}


RSS_county39_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyamira"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$NYAMIRA - fit)^2)
}


RSS_county40_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Vihiga"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$VIHIGA - fit)^2)
}


RSS_county41_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Lamu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$LAMU - fit)^2)
}


RSS_county42_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyandarua"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$NYANDARUA - fit)^2)
}

RSS_county43_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tharaka-Nithi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`THARAKA NITHI` - fit)^2)
}

RSS_county44_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tana River"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`TANA RIVER` - fit)^2)
}
 
RSS_county45_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Baringo"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$BARINGO - fit)^2)
}

RSS_county46_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "West Pokot"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$`WEST POKOT` - fit)^2)
}


RSS_county47_Mar20_May21_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Samburu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df$SAMBURU - fit)^2)
}


opt_county1_Mar20_May21_beta <- optim(c(1/7), RSS_county1_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county2_Mar20_May21_beta <- optim(c(1/7), RSS_county2_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county3_Mar20_May21_beta <- optim(c(1/7), RSS_county3_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county4_Mar20_May21_beta <- optim(c(1/7), RSS_county4_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county5_Mar20_May21_beta <- optim(c(1/7), RSS_county5_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county6_Mar20_May21_beta <- optim(c(1/7), RSS_county6_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county7_Mar20_May21_beta <- optim(c(1/7), RSS_county7_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county8_Mar20_May21_beta <- optim(c(1/7), RSS_county8_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county9_Mar20_May21_beta <- optim(c(1/7), RSS_county9_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county10_Mar20_May21_beta <- optim(c(1/7), RSS_county10_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county11_Mar20_May21_beta <- optim(c(1/7), RSS_county11_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county12_Mar20_May21_beta <- optim(c(1/7), RSS_county12_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county13_Mar20_May21_beta <- optim(c(1/7), RSS_county13_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county14_Mar20_May21_beta <- optim(c(1/7), RSS_county14_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county15_Mar20_May21_beta <- optim(c(1/7), RSS_county15_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county16_Mar20_May21_beta <- optim(c(1/7), RSS_county16_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county17_Mar20_May21_beta <- optim(c(1/7), RSS_county17_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county18_Mar20_May21_beta <- optim(c(1/7), RSS_county18_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county19_Mar20_May21_beta <- optim(c(1/7), RSS_county19_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county20_Mar20_May21_beta <- optim(c(1/7), RSS_county20_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county21_Mar20_May21_beta <- optim(c(1/7), RSS_county21_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county22_Mar20_May21_beta <- optim(c(1/7), RSS_county22_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county23_Mar20_May21_beta <- optim(c(1/7), RSS_county23_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county24_Mar20_May21_beta <- optim(c(1/7), RSS_county24_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county25_Mar20_May21_beta <- optim(c(1/7), RSS_county25_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county26_Mar20_May21_beta <- optim(c(1/7), RSS_county26_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county27_Mar20_May21_beta <- optim(c(1/7), RSS_county27_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county28_Mar20_May21_beta <- optim(c(1/7), RSS_county28_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county29_Mar20_May21_beta <- optim(c(1/7), RSS_county29_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county30_Mar20_May21_beta <- optim(c(1/7), RSS_county30_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county31_Mar20_May21_beta <- optim(c(1/7), RSS_county31_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county32_Mar20_May21_beta <- optim(c(1/7), RSS_county32_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county33_Mar20_May21_beta <- optim(c(1/7), RSS_county33_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county34_Mar20_May21_beta <- optim(c(1/7), RSS_county34_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county35_Mar20_May21_beta <- optim(c(1/7), RSS_county35_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county36_Mar20_May21_beta <- optim(c(1/7), RSS_county36_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county37_Mar20_May21_beta <- optim(c(1/7), RSS_county37_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county38_Mar20_May21_beta <- optim(c(1/7), RSS_county38_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county39_Mar20_May21_beta <- optim(c(1/7), RSS_county39_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county40_Mar20_May21_beta <- optim(c(1/7), RSS_county40_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county41_Mar20_May21_beta <- optim(c(1/7), RSS_county41_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county42_Mar20_May21_beta <- optim(c(1/7), RSS_county42_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county43_Mar20_May21_beta <- optim(c(1/7), RSS_county43_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county44_Mar20_May21_beta <- optim(c(1/7), RSS_county44_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county45_Mar20_May21_beta <- optim(c(1/7), RSS_county45_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county46_Mar20_May21_beta <- optim(c(1/7), RSS_county46_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county47_Mar20_May21_beta <- optim(c(1/7), RSS_county47_Mar20_May21_beta,
                                      method = "Brent", lower = 0, upper = 1)



opt_county1_Mar20_May21_par_beta <- setNames(opt_county1_Mar20_May21_beta$par, c("beta"))

opt_county2_Mar20_May21_par_beta <- setNames(opt_county2_Mar20_May21_beta$par, c("beta"))

opt_county3_Mar20_May21_par_beta <- setNames(opt_county3_Mar20_May21_beta$par, c("beta"))

opt_county4_Mar20_May21_par_beta <- setNames(opt_county4_Mar20_May21_beta$par, c("beta"))

opt_county5_Mar20_May21_par_beta <- setNames(opt_county5_Mar20_May21_beta$par, c("beta"))

opt_county6_Mar20_May21_par_beta <- setNames(opt_county6_Mar20_May21_beta$par, c("beta"))

opt_county7_Mar20_May21_par_beta <- setNames(opt_county7_Mar20_May21_beta$par, c("beta"))

opt_county8_Mar20_May21_par_beta <- setNames(opt_county8_Mar20_May21_beta$par, c("beta"))

opt_county9_Mar20_May21_par_beta <- setNames(opt_county9_Mar20_May21_beta$par, c("beta"))

opt_county10_Mar20_May21_par_beta <- setNames(opt_county10_Mar20_May21_beta$par, c("beta"))

opt_county11_Mar20_May21_par_beta <- setNames(opt_county11_Mar20_May21_beta$par, c("beta"))

opt_county12_Mar20_May21_par_beta <- setNames(opt_county12_Mar20_May21_beta$par, c("beta"))

opt_county13_Mar20_May21_par_beta <- setNames(opt_county13_Mar20_May21_beta$par, c("beta"))

opt_county14_Mar20_May21_par_beta <- setNames(opt_county14_Mar20_May21_beta$par, c("beta"))

opt_county15_Mar20_May21_par_beta <- setNames(opt_county15_Mar20_May21_beta$par, c("beta"))

opt_county16_Mar20_May21_par_beta <- setNames(opt_county16_Mar20_May21_beta$par, c("beta"))

opt_county17_Mar20_May21_par_beta <- setNames(opt_county17_Mar20_May21_beta$par, c("beta"))

opt_county18_Mar20_May21_par_beta <- setNames(opt_county18_Mar20_May21_beta$par, c("beta"))

opt_county19_Mar20_May21_par_beta <- setNames(opt_county19_Mar20_May21_beta$par, c("beta"))

opt_county20_Mar20_May21_par_beta <- setNames(opt_county20_Mar20_May21_beta$par, c("beta"))

opt_county21_Mar20_May21_par_beta <- setNames(opt_county21_Mar20_May21_beta$par, c("beta"))

opt_county22_Mar20_May21_par_beta <- setNames(opt_county22_Mar20_May21_beta$par, c("beta"))

opt_county23_Mar20_May21_par_beta <- setNames(opt_county23_Mar20_May21_beta$par, c("beta"))

opt_county24_Mar20_May21_par_beta <- setNames(opt_county24_Mar20_May21_beta$par, c("beta"))

opt_county25_Mar20_May21_par_beta <- setNames(opt_county25_Mar20_May21_beta$par, c("beta"))

opt_county26_Mar20_May21_par_beta <- setNames(opt_county26_Mar20_May21_beta$par, c("beta"))

opt_county27_Mar20_May21_par_beta <- setNames(opt_county27_Mar20_May21_beta$par, c("beta"))

opt_county28_Mar20_May21_par_beta <- setNames(opt_county28_Mar20_May21_beta$par, c("beta"))

opt_county29_Mar20_May21_par_beta <- setNames(opt_county29_Mar20_May21_beta$par, c("beta"))

opt_county30_Mar20_May21_par_beta <- setNames(opt_county30_Mar20_May21_beta$par, c("beta"))

opt_county31_Mar20_May21_par_beta <- setNames(opt_county31_Mar20_May21_beta$par, c("beta"))

opt_county32_Mar20_May21_par_beta <- setNames(opt_county32_Mar20_May21_beta$par, c("beta"))

opt_county33_Mar20_May21_par_beta <- setNames(opt_county33_Mar20_May21_beta$par, c("beta"))

opt_county34_Mar20_May21_par_beta <- setNames(opt_county34_Mar20_May21_beta$par, c("beta"))

opt_county35_Mar20_May21_par_beta <- setNames(opt_county35_Mar20_May21_beta$par, c("beta"))

opt_county36_Mar20_May21_par_beta <- setNames(opt_county36_Mar20_May21_beta$par, c("beta"))

opt_county37_Mar20_May21_par_beta <- setNames(opt_county37_Mar20_May21_beta$par, c("beta"))

opt_county38_Mar20_May21_par_beta <- setNames(opt_county38_Mar20_May21_beta$par, c("beta"))

opt_county39_Mar20_May21_par_beta <- setNames(opt_county39_Mar20_May21_beta$par, c("beta"))

opt_county40_Mar20_May21_par_beta <- setNames(opt_county40_Mar20_May21_beta$par, c("beta"))

opt_county41_Mar20_May21_par_beta <- setNames(opt_county41_Mar20_May21_beta$par, c("beta"))

opt_county42_Mar20_May21_par_beta <- setNames(opt_county42_Mar20_May21_beta$par, c("beta"))

opt_county43_Mar20_May21_par_beta <- setNames(opt_county43_Mar20_May21_beta$par, c("beta"))

opt_county44_Mar20_May21_par_beta <- setNames(opt_county44_Mar20_May21_beta$par, c("beta"))

opt_county45_Mar20_May21_par_beta <- setNames(opt_county45_Mar20_May21_beta$par, c("beta"))

opt_county46_Mar20_May21_par_beta <- setNames(opt_county46_Mar20_May21_beta$par, c("beta"))

opt_county47_Mar20_May21_par_beta <- setNames(opt_county47_Mar20_May21_beta$par, c("beta"))


opt_county1_Mar20_May21_par_Ro <- setNames(opt_county1_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county2_Mar20_May21_par_Ro <- setNames(opt_county2_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county3_Mar20_May21_par_Ro <- setNames(opt_county3_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county4_Mar20_May21_par_Ro <- setNames(opt_county4_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county5_Mar20_May21_par_Ro <- setNames(opt_county5_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county6_Mar20_May21_par_Ro <- setNames(opt_county6_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county7_Mar20_May21_par_Ro <- setNames(opt_county7_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county8_Mar20_May21_par_Ro <- setNames(opt_county8_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county9_Mar20_May21_par_Ro <- setNames(opt_county9_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county10_Mar20_May21_par_Ro <- setNames(opt_county10_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county11_Mar20_May21_par_Ro <- setNames(opt_county11_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county12_Mar20_May21_par_Ro <- setNames(opt_county12_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county13_Mar20_May21_par_Ro <- setNames(opt_county13_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county14_Mar20_May21_par_Ro <- setNames(opt_county14_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county15_Mar20_May21_par_Ro <- setNames(opt_county15_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county16_Mar20_May21_par_Ro <- setNames(opt_county16_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county17_Mar20_May21_par_Ro <- setNames(opt_county17_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county18_Mar20_May21_par_Ro <- setNames(opt_county18_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county19_Mar20_May21_par_Ro <- setNames(opt_county19_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county20_Mar20_May21_par_Ro <- setNames(opt_county20_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county21_Mar20_May21_par_Ro <- setNames(opt_county21_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county22_Mar20_May21_par_Ro <- setNames(opt_county22_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county23_Mar20_May21_par_Ro <- setNames(opt_county23_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county24_Mar20_May21_par_Ro <- setNames(opt_county24_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county25_Mar20_May21_par_Ro <- setNames(opt_county25_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county26_Mar20_May21_par_Ro <- setNames(opt_county26_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county27_Mar20_May21_par_Ro <- setNames(opt_county27_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county28_Mar20_May21_par_Ro <- setNames(opt_county28_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county29_Mar20_May21_par_Ro <- setNames(opt_county29_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county30_Mar20_May21_par_Ro <- setNames(opt_county30_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county31_Mar20_May21_par_Ro <- setNames(opt_county31_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county32_Mar20_May21_par_Ro <- setNames(opt_county32_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county33_Mar20_May21_par_Ro <- setNames(opt_county33_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county34_Mar20_May21_par_Ro <- setNames(opt_county34_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county35_Mar20_May21_par_Ro <- setNames(opt_county35_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county36_Mar20_May21_par_Ro <- setNames(opt_county36_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county37_Mar20_May21_par_Ro <- setNames(opt_county37_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county38_Mar20_May21_par_Ro <- setNames(opt_county38_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county39_Mar20_May21_par_Ro <- setNames(opt_county39_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county40_Mar20_May21_par_Ro <- setNames(opt_county40_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county41_Mar20_May21_par_Ro <- setNames(opt_county41_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county42_Mar20_May21_par_Ro <- setNames(opt_county42_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county43_Mar20_May21_par_Ro <- setNames(opt_county43_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county44_Mar20_May21_par_Ro <- setNames(opt_county44_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county45_Mar20_May21_par_Ro <- setNames(opt_county45_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county46_Mar20_May21_par_Ro <- setNames(opt_county46_Mar20_May21_par_beta[1]/(1/14), "Ro" )

opt_county47_Mar20_May21_par_Ro <- setNames(opt_county47_Mar20_May21_par_beta[1]/(1/14), "Ro" )


```



```{r, include=FALSE}

#As at beginning

RSS_county1_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kajiado"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KAJIADO - fit)^2)
}


RSS_county2_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nairobi City"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$NAIROBI - fit)^2)
}

RSS_county3_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kwale"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KWALE - fit)^2)
}

RSS_county4_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kilifi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KILIFI - fit)^2)
}
 
RSS_county5_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mombasa"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$MOMBASA - fit)^2)
}

RSS_county6_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kakamega"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KAKAMEGA - fit)^2)
}


RSS_county7_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kitui"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KITUI - fit)^2)
}


RSS_county8_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nakuru"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$NAKURU - fit)^2)
}


RSS_county9_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mandera"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$MANDERA - fit)^2)
}


RSS_county10_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Uasin Gishu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`UASIN GISHU` - fit)^2)
}

RSS_county11_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Siaya"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$SIAYA - fit)^2)
}


RSS_county12_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Homa Bay"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`HOMA BAY` - fit)^2)
}

RSS_county13_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kiambu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KIAMBU - fit)^2)
}

RSS_county14_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Wajir"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$WAJIR - fit)^2)
}
 
RSS_county15_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Migori"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$MIGORI - fit)^2)
}

RSS_county16_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bungoma"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$BUNGOMA - fit)^2)
}


RSS_county17_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Busia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$BUSIA - fit)^2)
}


RSS_county18_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Isiolo"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$ISIOLO - fit)^2)
}


RSS_county19_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Machakos"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$MACHAKOS - fit)^2)
}


RSS_county20_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bomet"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$BOMET - fit)^2)
    
}


RSS_county21_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Taita/Taveta"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`TAITA TAVETA` - fit)^2)
}


RSS_county22_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Garissa"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$GARISSA - fit)^2)
}

RSS_county23_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Makueni"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$MAKUENI - fit)^2)
}

RSS_county24_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisii"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KISII - fit)^2)
}
 
RSS_county25_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Meru"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$MERU - fit)^2)
}

RSS_county26_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kirinyaga"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KIRINYAGA - fit)^2)
}


RSS_county27_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Trans Nzoia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`TRANS NZOIA` - fit)^2)
}


RSS_county28_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisumu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KISUMU - fit)^2)
}


RSS_county29_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Turkana"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$TURKANA - fit)^2)
}


RSS_county30_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Embu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$EMBU - fit)^2)
}


RSS_county31_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyeri"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$NYERI - fit)^2)
}


RSS_county32_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Murang'a"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`MURANG'A` - fit)^2)
}

RSS_county33_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kericho"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$KERICHO - fit)^2)
}

RSS_county34_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Laikipia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$LAIKIPIA - fit)^2)
}
 
RSS_county35_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nandi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$NANDI - fit)^2)
}

RSS_county36_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Elgeyo/Marakwet"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`ELGEYO MARAKWET` - fit)^2)
}


RSS_county37_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Marsabit"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$MARSABIT - fit)^2)
}


RSS_county38_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Narok"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$NAROK - fit)^2)
}


RSS_county39_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyamira"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$NYAMIRA - fit)^2)
}


RSS_county40_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Vihiga"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$VIHIGA - fit)^2)
}


RSS_county41_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Lamu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$LAMU - fit)^2)
}


RSS_county42_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyandarua"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$NYANDARUA - fit)^2)
}

RSS_county43_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tharaka-Nithi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`THARAKA NITHI` - fit)^2)
}

RSS_county44_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tana River"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`TANA RIVER` - fit)^2)
}
 
RSS_county45_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Baringo"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$BARINGO - fit)^2)
}

RSS_county46_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "West Pokot"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$`WEST POKOT` - fit)^2)
}


RSS_county47_Beginning_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Samburu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/03/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df1$SAMBURU - fit)^2)
}


opt_county1_Beginning_beta <- optim(c(1/7), RSS_county1_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county2_Beginning_beta <- optim(c(1/7), RSS_county2_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county3_Beginning_beta <- optim(c(1/7), RSS_county3_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county4_Beginning_beta <- optim(c(1/7), RSS_county4_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county5_Beginning_beta <- optim(c(1/7), RSS_county5_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county6_Beginning_beta <- optim(c(1/7), RSS_county6_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county7_Beginning_beta <- optim(c(1/7), RSS_county7_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county8_Beginning_beta <- optim(c(1/7), RSS_county8_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county9_Beginning_beta <- optim(c(1/7), RSS_county9_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county10_Beginning_beta <- optim(c(1/7), RSS_county10_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county11_Beginning_beta <- optim(c(1/7), RSS_county11_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county12_Beginning_beta <- optim(c(1/7), RSS_county12_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county13_Beginning_beta <- optim(c(1/7), RSS_county13_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county14_Beginning_beta <- optim(c(1/7), RSS_county14_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county15_Beginning_beta <- optim(c(1/7), RSS_county15_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county16_Beginning_beta <- optim(c(1/7), RSS_county16_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county17_Beginning_beta <- optim(c(1/7), RSS_county17_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county18_Beginning_beta <- optim(c(1/7), RSS_county18_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county19_Beginning_beta <- optim(c(1/7), RSS_county19_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county20_Beginning_beta <- optim(c(1/7), RSS_county20_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county21_Beginning_beta <- optim(c(1/7), RSS_county21_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county22_Beginning_beta <- optim(c(1/7), RSS_county22_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county23_Beginning_beta <- optim(c(1/7), RSS_county23_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county24_Beginning_beta <- optim(c(1/7), RSS_county24_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county25_Beginning_beta <- optim(c(1/7), RSS_county25_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county26_Beginning_beta <- optim(c(1/7), RSS_county26_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county27_Beginning_beta <- optim(c(1/7), RSS_county27_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county28_Beginning_beta <- optim(c(1/7), RSS_county28_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county29_Beginning_beta <- optim(c(1/7), RSS_county29_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county30_Beginning_beta <- optim(c(1/7), RSS_county30_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county31_Beginning_beta <- optim(c(1/7), RSS_county31_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county32_Beginning_beta <- optim(c(1/7), RSS_county32_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county33_Beginning_beta <- optim(c(1/7), RSS_county33_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county34_Beginning_beta <- optim(c(1/7), RSS_county34_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county35_Beginning_beta <- optim(c(1/7), RSS_county35_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county36_Beginning_beta <- optim(c(1/7), RSS_county36_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county37_Beginning_beta <- optim(c(1/7), RSS_county37_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county38_Beginning_beta <- optim(c(1/7), RSS_county38_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county39_Beginning_beta <- optim(c(1/7), RSS_county39_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county40_Beginning_beta <- optim(c(1/7), RSS_county40_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county41_Beginning_beta <- optim(c(1/7), RSS_county41_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county42_Beginning_beta <- optim(c(1/7), RSS_county42_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county43_Beginning_beta <- optim(c(1/7), RSS_county43_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county44_Beginning_beta <- optim(c(1/7), RSS_county44_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county45_Beginning_beta <- optim(c(1/7), RSS_county45_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county46_Beginning_beta <- optim(c(1/7), RSS_county46_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county47_Beginning_beta <- optim(c(1/7), RSS_county47_Beginning_beta,
                                      method = "Brent", lower = 0, upper = 1)



opt_county1_Beginning_par_beta <- setNames(opt_county1_Beginning_beta$par, c("beta"))

opt_county2_Beginning_par_beta <- setNames(opt_county2_Beginning_beta$par, c("beta"))

opt_county3_Beginning_par_beta <- setNames(opt_county3_Beginning_beta$par, c("beta"))

opt_county4_Beginning_par_beta <- setNames(opt_county4_Beginning_beta$par, c("beta"))

opt_county5_Beginning_par_beta <- setNames(opt_county5_Beginning_beta$par, c("beta"))

opt_county6_Beginning_par_beta <- setNames(opt_county6_Beginning_beta$par, c("beta"))

opt_county7_Beginning_par_beta <- setNames(opt_county7_Beginning_beta$par, c("beta"))

opt_county8_Beginning_par_beta <- setNames(opt_county8_Beginning_beta$par, c("beta"))

opt_county9_Beginning_par_beta <- setNames(opt_county9_Beginning_beta$par, c("beta"))

opt_county10_Beginning_par_beta <- setNames(opt_county10_Beginning_beta$par, c("beta"))

opt_county11_Beginning_par_beta <- setNames(opt_county11_Beginning_beta$par, c("beta"))

opt_county12_Beginning_par_beta <- setNames(opt_county12_Beginning_beta$par, c("beta"))

opt_county13_Beginning_par_beta <- setNames(opt_county13_Beginning_beta$par, c("beta"))

opt_county14_Beginning_par_beta <- setNames(opt_county14_Beginning_beta$par, c("beta"))

opt_county15_Beginning_par_beta <- setNames(opt_county15_Beginning_beta$par, c("beta"))

opt_county16_Beginning_par_beta <- setNames(opt_county16_Beginning_beta$par, c("beta"))

opt_county17_Beginning_par_beta <- setNames(opt_county17_Beginning_beta$par, c("beta"))

opt_county18_Beginning_par_beta <- setNames(opt_county18_Beginning_beta$par, c("beta"))

opt_county19_Beginning_par_beta <- setNames(opt_county19_Beginning_beta$par, c("beta"))

opt_county20_Beginning_par_beta <- setNames(opt_county20_Beginning_beta$par, c("beta"))

opt_county21_Beginning_par_beta <- setNames(opt_county21_Beginning_beta$par, c("beta"))

opt_county22_Beginning_par_beta <- setNames(opt_county22_Beginning_beta$par, c("beta"))

opt_county23_Beginning_par_beta <- setNames(opt_county23_Beginning_beta$par, c("beta"))

opt_county24_Beginning_par_beta <- setNames(opt_county24_Beginning_beta$par, c("beta"))

opt_county25_Beginning_par_beta <- setNames(opt_county25_Beginning_beta$par, c("beta"))

opt_county26_Beginning_par_beta <- setNames(opt_county26_Beginning_beta$par, c("beta"))

opt_county27_Beginning_par_beta <- setNames(opt_county27_Beginning_beta$par, c("beta"))

opt_county28_Beginning_par_beta <- setNames(opt_county28_Beginning_beta$par, c("beta"))

opt_county29_Beginning_par_beta <- setNames(opt_county29_Beginning_beta$par, c("beta"))

opt_county30_Beginning_par_beta <- setNames(opt_county30_Beginning_beta$par, c("beta"))

opt_county31_Beginning_par_beta <- setNames(opt_county31_Beginning_beta$par, c("beta"))

opt_county32_Beginning_par_beta <- setNames(opt_county32_Beginning_beta$par, c("beta"))

opt_county33_Beginning_par_beta <- setNames(opt_county33_Beginning_beta$par, c("beta"))

opt_county34_Beginning_par_beta <- setNames(opt_county34_Beginning_beta$par, c("beta"))

opt_county35_Beginning_par_beta <- setNames(opt_county35_Beginning_beta$par, c("beta"))

opt_county36_Beginning_par_beta <- setNames(opt_county36_Beginning_beta$par, c("beta"))

opt_county37_Beginning_par_beta <- setNames(opt_county37_Beginning_beta$par, c("beta"))

opt_county38_Beginning_par_beta <- setNames(opt_county38_Beginning_beta$par, c("beta"))

opt_county39_Beginning_par_beta <- setNames(opt_county39_Beginning_beta$par, c("beta"))

opt_county40_Beginning_par_beta <- setNames(opt_county40_Beginning_beta$par, c("beta"))

opt_county41_Beginning_par_beta <- setNames(opt_county41_Beginning_beta$par, c("beta"))

opt_county42_Beginning_par_beta <- setNames(opt_county42_Beginning_beta$par, c("beta"))

opt_county43_Beginning_par_beta <- setNames(opt_county43_Beginning_beta$par, c("beta"))

opt_county44_Beginning_par_beta <- setNames(opt_county44_Beginning_beta$par, c("beta"))

opt_county45_Beginning_par_beta <- setNames(opt_county45_Beginning_beta$par, c("beta"))

opt_county46_Beginning_par_beta <- setNames(opt_county46_Beginning_beta$par, c("beta"))

opt_county47_Beginning_par_beta <- setNames(opt_county47_Beginning_beta$par, c("beta"))


opt_county1_Beginning_par_Ro <- setNames(opt_county1_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county2_Beginning_par_Ro <- setNames(opt_county2_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county3_Beginning_par_Ro <- setNames(opt_county3_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county4_Beginning_par_Ro <- setNames(opt_county4_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county5_Beginning_par_Ro <- setNames(opt_county5_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county6_Beginning_par_Ro <- setNames(opt_county6_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county7_Beginning_par_Ro <- setNames(opt_county7_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county8_Beginning_par_Ro <- setNames(opt_county8_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county9_Beginning_par_Ro <- setNames(opt_county9_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county10_Beginning_par_Ro <- setNames(opt_county10_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county11_Beginning_par_Ro <- setNames(opt_county11_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county12_Beginning_par_Ro <- setNames(opt_county12_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county13_Beginning_par_Ro <- setNames(opt_county13_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county14_Beginning_par_Ro <- setNames(opt_county14_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county15_Beginning_par_Ro <- setNames(opt_county15_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county16_Beginning_par_Ro <- setNames(opt_county16_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county17_Beginning_par_Ro <- setNames(opt_county17_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county18_Beginning_par_Ro <- setNames(opt_county18_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county19_Beginning_par_Ro <- setNames(opt_county19_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county20_Beginning_par_Ro <- setNames(opt_county20_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county21_Beginning_par_Ro <- setNames(opt_county21_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county22_Beginning_par_Ro <- setNames(opt_county22_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county23_Beginning_par_Ro <- setNames(opt_county23_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county24_Beginning_par_Ro <- setNames(opt_county24_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county25_Beginning_par_Ro <- setNames(opt_county25_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county26_Beginning_par_Ro <- setNames(opt_county26_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county27_Beginning_par_Ro <- setNames(opt_county27_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county28_Beginning_par_Ro <- setNames(opt_county28_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county29_Beginning_par_Ro <- setNames(opt_county29_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county30_Beginning_par_Ro <- setNames(opt_county30_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county31_Beginning_par_Ro <- setNames(opt_county31_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county32_Beginning_par_Ro <- setNames(opt_county32_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county33_Beginning_par_Ro <- setNames(opt_county33_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county34_Beginning_par_Ro <- setNames(opt_county34_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county35_Beginning_par_Ro <- setNames(opt_county35_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county36_Beginning_par_Ro <- setNames(opt_county36_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county37_Beginning_par_Ro <- setNames(opt_county37_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county38_Beginning_par_Ro <- setNames(opt_county38_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county39_Beginning_par_Ro <- setNames(opt_county39_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county40_Beginning_par_Ro <- setNames(opt_county40_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county41_Beginning_par_Ro <- setNames(opt_county41_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county42_Beginning_par_Ro <- setNames(opt_county42_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county43_Beginning_par_Ro <- setNames(opt_county43_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county44_Beginning_par_Ro <- setNames(opt_county44_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county45_Beginning_par_Ro <- setNames(opt_county45_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county46_Beginning_par_Ro <- setNames(opt_county46_Beginning_par_beta[1]/(1/14), "Ro" )

opt_county47_Beginning_par_Ro <- setNames(opt_county47_Beginning_par_beta[1]/(1/14), "Ro" )


```



```{r}

#Total Lockdown

RSS_county1_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kajiado"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KAJIADO - fit)^2)
}


RSS_county2_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nairobi City"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$NAIROBI - fit)^2)
}

RSS_county3_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kwale"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KWALE - fit)^2)
}

RSS_county4_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kilifi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KILIFI - fit)^2)
}
 
RSS_county5_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mombasa"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$MOMBASA - fit)^2)
}

RSS_county6_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kakamega"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KAKAMEGA - fit)^2)
}


RSS_county7_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kitui"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KITUI - fit)^2)
}


RSS_county8_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nakuru"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$NAKURU - fit)^2)
}


RSS_county9_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mandera"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$MANDERA - fit)^2)
}


RSS_county10_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Uasin Gishu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`UASIN GISHU` - fit)^2)
}

RSS_county11_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Siaya"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$SIAYA - fit)^2)
}


RSS_county12_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Homa Bay"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`HOMA BAY` - fit)^2)
}

RSS_county13_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kiambu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KIAMBU - fit)^2)
}

RSS_county14_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Wajir"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$WAJIR - fit)^2)
}
 
RSS_county15_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Migori"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$MIGORI - fit)^2)
}

RSS_county16_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bungoma"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$BUNGOMA - fit)^2)
}


RSS_county17_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Busia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$BUSIA - fit)^2)
}


RSS_county18_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Isiolo"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$ISIOLO - fit)^2)
}


RSS_county19_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Machakos"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$MACHAKOS - fit)^2)
}


RSS_county20_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bomet"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$BOMET - fit)^2)
    
}


RSS_county21_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Taita/Taveta"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`TAITA TAVETA` - fit)^2)
}


RSS_county22_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Garissa"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$GARISSA - fit)^2)
}

RSS_county23_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Makueni"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$MAKUENI - fit)^2)
}

RSS_county24_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisii"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KISII - fit)^2)
}
 
RSS_county25_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Meru"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$MERU - fit)^2)
}

RSS_county26_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kirinyaga"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KIRINYAGA - fit)^2)
}


RSS_county27_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Trans Nzoia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`TRANS NZOIA` - fit)^2)
}


RSS_county28_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisumu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KISUMU - fit)^2)
}


RSS_county29_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Turkana"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$TURKANA - fit)^2)
}


RSS_county30_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Embu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$EMBU - fit)^2)
}


RSS_county31_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyeri"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$NYERI - fit)^2)
}


RSS_county32_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Murang'a"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`MURANG'A` - fit)^2)
}

RSS_county33_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kericho"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$KERICHO - fit)^2)
}

RSS_county34_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Laikipia"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$LAIKIPIA - fit)^2)
}
 
RSS_county35_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nandi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$NANDI - fit)^2)
}

RSS_county36_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Elgeyo/Marakwet"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`ELGEYO MARAKWET` - fit)^2)
}


RSS_county37_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Marsabit"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$MARSABIT - fit)^2)
}


RSS_county38_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Narok"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$NAROK - fit)^2)
}


RSS_county39_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyamira"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$NYAMIRA - fit)^2)
}


RSS_county40_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Vihiga"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$VIHIGA - fit)^2)
}


RSS_county41_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Lamu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$LAMU - fit)^2)
}


RSS_county42_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyandarua"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$NYANDARUA - fit)^2)
}

RSS_county43_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tharaka-Nithi"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`THARAKA NITHI` - fit)^2)
}

RSS_county44_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tana River"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`TANA RIVER` - fit)^2)
}
 
RSS_county45_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Baringo"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$BARINGO - fit)^2)
}

RSS_county46_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "West Pokot"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$`WEST POKOT` - fit)^2)
}


RSS_county47_TotalLockdown_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Samburu"])-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/03/12"), as.Date("2020/07/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df2$SAMBURU - fit)^2)
}


opt_county1_TotalLockdown_beta <- optim(c(1/7), RSS_county1_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county2_TotalLockdown_beta <- optim(c(1/7), RSS_county2_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county3_TotalLockdown_beta <- optim(c(1/7), RSS_county3_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county4_TotalLockdown_beta <- optim(c(1/7), RSS_county4_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county5_TotalLockdown_beta <- optim(c(1/7), RSS_county5_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county6_TotalLockdown_beta <- optim(c(1/7), RSS_county6_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county7_TotalLockdown_beta <- optim(c(1/7), RSS_county7_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county8_TotalLockdown_beta <- optim(c(1/7), RSS_county8_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county9_TotalLockdown_beta <- optim(c(1/7), RSS_county9_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county10_TotalLockdown_beta <- optim(c(1/7), RSS_county10_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county11_TotalLockdown_beta <- optim(c(1/7), RSS_county11_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county12_TotalLockdown_beta <- optim(c(1/7), RSS_county12_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county13_TotalLockdown_beta <- optim(c(1/7), RSS_county13_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county14_TotalLockdown_beta <- optim(c(1/7), RSS_county14_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county15_TotalLockdown_beta <- optim(c(1/7), RSS_county15_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county16_TotalLockdown_beta <- optim(c(1/7), RSS_county16_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county17_TotalLockdown_beta <- optim(c(1/7), RSS_county17_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county18_TotalLockdown_beta <- optim(c(1/7), RSS_county18_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county19_TotalLockdown_beta <- optim(c(1/7), RSS_county19_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county20_TotalLockdown_beta <- optim(c(1/7), RSS_county20_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county21_TotalLockdown_beta <- optim(c(1/7), RSS_county21_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county22_TotalLockdown_beta <- optim(c(1/7), RSS_county22_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county23_TotalLockdown_beta <- optim(c(1/7), RSS_county23_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county24_TotalLockdown_beta <- optim(c(1/7), RSS_county24_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county25_TotalLockdown_beta <- optim(c(1/7), RSS_county25_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county26_TotalLockdown_beta <- optim(c(1/7), RSS_county26_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county27_TotalLockdown_beta <- optim(c(1/7), RSS_county27_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county28_TotalLockdown_beta <- optim(c(1/7), RSS_county28_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county29_TotalLockdown_beta <- optim(c(1/7), RSS_county29_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county30_TotalLockdown_beta <- optim(c(1/7), RSS_county30_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county31_TotalLockdown_beta <- optim(c(1/7), RSS_county31_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county32_TotalLockdown_beta <- optim(c(1/7), RSS_county32_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county33_TotalLockdown_beta <- optim(c(1/7), RSS_county33_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county34_TotalLockdown_beta <- optim(c(1/7), RSS_county34_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county35_TotalLockdown_beta <- optim(c(1/7), RSS_county35_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county36_TotalLockdown_beta <- optim(c(1/7), RSS_county36_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county37_TotalLockdown_beta <- optim(c(1/7), RSS_county37_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county38_TotalLockdown_beta <- optim(c(1/7), RSS_county38_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county39_TotalLockdown_beta <- optim(c(1/7), RSS_county39_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county40_TotalLockdown_beta <- optim(c(1/7), RSS_county40_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county41_TotalLockdown_beta <- optim(c(1/7), RSS_county41_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county42_TotalLockdown_beta <- optim(c(1/7), RSS_county42_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county43_TotalLockdown_beta <- optim(c(1/7), RSS_county43_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county44_TotalLockdown_beta <- optim(c(1/7), RSS_county44_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county45_TotalLockdown_beta <- optim(c(1/7), RSS_county45_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county46_TotalLockdown_beta <- optim(c(1/7), RSS_county46_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county47_TotalLockdown_beta <- optim(c(1/7), RSS_county47_TotalLockdown_beta,
                                      method = "Brent", lower = 0, upper = 1)



opt_county1_TotalLockdown_par_beta <- setNames(opt_county1_TotalLockdown_beta$par, c("beta"))

opt_county2_TotalLockdown_par_beta <- setNames(opt_county2_TotalLockdown_beta$par, c("beta"))

opt_county3_TotalLockdown_par_beta <- setNames(opt_county3_TotalLockdown_beta$par, c("beta"))

opt_county4_TotalLockdown_par_beta <- setNames(opt_county4_TotalLockdown_beta$par, c("beta"))

opt_county5_TotalLockdown_par_beta <- setNames(opt_county5_TotalLockdown_beta$par, c("beta"))

opt_county6_TotalLockdown_par_beta <- setNames(opt_county6_TotalLockdown_beta$par, c("beta"))

opt_county7_TotalLockdown_par_beta <- setNames(opt_county7_TotalLockdown_beta$par, c("beta"))

opt_county8_TotalLockdown_par_beta <- setNames(opt_county8_TotalLockdown_beta$par, c("beta"))

opt_county9_TotalLockdown_par_beta <- setNames(opt_county9_TotalLockdown_beta$par, c("beta"))

opt_county10_TotalLockdown_par_beta <- setNames(opt_county10_TotalLockdown_beta$par, c("beta"))

opt_county11_TotalLockdown_par_beta <- setNames(opt_county11_TotalLockdown_beta$par, c("beta"))

opt_county12_TotalLockdown_par_beta <- setNames(opt_county12_TotalLockdown_beta$par, c("beta"))

opt_county13_TotalLockdown_par_beta <- setNames(opt_county13_TotalLockdown_beta$par, c("beta"))

opt_county14_TotalLockdown_par_beta <- setNames(opt_county14_TotalLockdown_beta$par, c("beta"))

opt_county15_TotalLockdown_par_beta <- setNames(opt_county15_TotalLockdown_beta$par, c("beta"))

opt_county16_TotalLockdown_par_beta <- setNames(opt_county16_TotalLockdown_beta$par, c("beta"))

opt_county17_TotalLockdown_par_beta <- setNames(opt_county17_TotalLockdown_beta$par, c("beta"))

opt_county18_TotalLockdown_par_beta <- setNames(opt_county18_TotalLockdown_beta$par, c("beta"))

opt_county19_TotalLockdown_par_beta <- setNames(opt_county19_TotalLockdown_beta$par, c("beta"))

opt_county20_TotalLockdown_par_beta <- setNames(opt_county20_TotalLockdown_beta$par, c("beta"))

opt_county21_TotalLockdown_par_beta <- setNames(opt_county21_TotalLockdown_beta$par, c("beta"))

opt_county22_TotalLockdown_par_beta <- setNames(opt_county22_TotalLockdown_beta$par, c("beta"))

opt_county23_TotalLockdown_par_beta <- setNames(opt_county23_TotalLockdown_beta$par, c("beta"))

opt_county24_TotalLockdown_par_beta <- setNames(opt_county24_TotalLockdown_beta$par, c("beta"))

opt_county25_TotalLockdown_par_beta <- setNames(opt_county25_TotalLockdown_beta$par, c("beta"))

opt_county26_TotalLockdown_par_beta <- setNames(opt_county26_TotalLockdown_beta$par, c("beta"))

opt_county27_TotalLockdown_par_beta <- setNames(opt_county27_TotalLockdown_beta$par, c("beta"))

opt_county28_TotalLockdown_par_beta <- setNames(opt_county28_TotalLockdown_beta$par, c("beta"))

opt_county29_TotalLockdown_par_beta <- setNames(opt_county29_TotalLockdown_beta$par, c("beta"))

opt_county30_TotalLockdown_par_beta <- setNames(opt_county30_TotalLockdown_beta$par, c("beta"))

opt_county31_TotalLockdown_par_beta <- setNames(opt_county31_TotalLockdown_beta$par, c("beta"))

opt_county32_TotalLockdown_par_beta <- setNames(opt_county32_TotalLockdown_beta$par, c("beta"))

opt_county33_TotalLockdown_par_beta <- setNames(opt_county33_TotalLockdown_beta$par, c("beta"))

opt_county34_TotalLockdown_par_beta <- setNames(opt_county34_TotalLockdown_beta$par, c("beta"))

opt_county35_TotalLockdown_par_beta <- setNames(opt_county35_TotalLockdown_beta$par, c("beta"))

opt_county36_TotalLockdown_par_beta <- setNames(opt_county36_TotalLockdown_beta$par, c("beta"))

opt_county37_TotalLockdown_par_beta <- setNames(opt_county37_TotalLockdown_beta$par, c("beta"))

opt_county38_TotalLockdown_par_beta <- setNames(opt_county38_TotalLockdown_beta$par, c("beta"))

opt_county39_TotalLockdown_par_beta <- setNames(opt_county39_TotalLockdown_beta$par, c("beta"))

opt_county40_TotalLockdown_par_beta <- setNames(opt_county40_TotalLockdown_beta$par, c("beta"))

opt_county41_TotalLockdown_par_beta <- setNames(opt_county41_TotalLockdown_beta$par, c("beta"))

opt_county42_TotalLockdown_par_beta <- setNames(opt_county42_TotalLockdown_beta$par, c("beta"))

opt_county43_TotalLockdown_par_beta <- setNames(opt_county43_TotalLockdown_beta$par, c("beta"))

opt_county44_TotalLockdown_par_beta <- setNames(opt_county44_TotalLockdown_beta$par, c("beta"))

opt_county45_TotalLockdown_par_beta <- setNames(opt_county45_TotalLockdown_beta$par, c("beta"))

opt_county46_TotalLockdown_par_beta <- setNames(opt_county46_TotalLockdown_beta$par, c("beta"))

opt_county47_TotalLockdown_par_beta <- setNames(opt_county47_TotalLockdown_beta$par, c("beta"))


opt_county1_TotalLockdown_par_Ro <- setNames(opt_county1_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county2_TotalLockdown_par_Ro <- setNames(opt_county2_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county3_TotalLockdown_par_Ro <- setNames(opt_county3_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county4_TotalLockdown_par_Ro <- setNames(opt_county4_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county5_TotalLockdown_par_Ro <- setNames(opt_county5_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county6_TotalLockdown_par_Ro <- setNames(opt_county6_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county7_TotalLockdown_par_Ro <- setNames(opt_county7_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county8_TotalLockdown_par_Ro <- setNames(opt_county8_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county9_TotalLockdown_par_Ro <- setNames(opt_county9_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county10_TotalLockdown_par_Ro <- setNames(opt_county10_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county11_TotalLockdown_par_Ro <- setNames(opt_county11_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county12_TotalLockdown_par_Ro <- setNames(opt_county12_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county13_TotalLockdown_par_Ro <- setNames(opt_county13_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county14_TotalLockdown_par_Ro <- setNames(opt_county14_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county15_TotalLockdown_par_Ro <- setNames(opt_county15_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county16_TotalLockdown_par_Ro <- setNames(opt_county16_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county17_TotalLockdown_par_Ro <- setNames(opt_county17_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county18_TotalLockdown_par_Ro <- setNames(opt_county18_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county19_TotalLockdown_par_Ro <- setNames(opt_county19_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county20_TotalLockdown_par_Ro <- setNames(opt_county20_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county21_TotalLockdown_par_Ro <- setNames(opt_county21_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county22_TotalLockdown_par_Ro <- setNames(opt_county22_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county23_TotalLockdown_par_Ro <- setNames(opt_county23_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county24_TotalLockdown_par_Ro <- setNames(opt_county24_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county25_TotalLockdown_par_Ro <- setNames(opt_county25_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county26_TotalLockdown_par_Ro <- setNames(opt_county26_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county27_TotalLockdown_par_Ro <- setNames(opt_county27_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county28_TotalLockdown_par_Ro <- setNames(opt_county28_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county29_TotalLockdown_par_Ro <- setNames(opt_county29_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county30_TotalLockdown_par_Ro <- setNames(opt_county30_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county31_TotalLockdown_par_Ro <- setNames(opt_county31_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county32_TotalLockdown_par_Ro <- setNames(opt_county32_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county33_TotalLockdown_par_Ro <- setNames(opt_county33_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county34_TotalLockdown_par_Ro <- setNames(opt_county34_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county35_TotalLockdown_par_Ro <- setNames(opt_county35_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county36_TotalLockdown_par_Ro <- setNames(opt_county36_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county37_TotalLockdown_par_Ro <- setNames(opt_county37_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county38_TotalLockdown_par_Ro <- setNames(opt_county38_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county39_TotalLockdown_par_Ro <- setNames(opt_county39_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county40_TotalLockdown_par_Ro <- setNames(opt_county40_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county41_TotalLockdown_par_Ro <- setNames(opt_county41_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county42_TotalLockdown_par_Ro <- setNames(opt_county42_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county43_TotalLockdown_par_Ro <- setNames(opt_county43_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county44_TotalLockdown_par_Ro <- setNames(opt_county44_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county45_TotalLockdown_par_Ro <- setNames(opt_county45_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county46_TotalLockdown_par_Ro <- setNames(opt_county46_TotalLockdown_par_beta[1]/(1/14), "Ro" )

opt_county47_TotalLockdown_par_Ro <- setNames(opt_county47_TotalLockdown_par_beta[1]/(1/14), "Ro" )


```



```{r, include=FALSE}

#Partially opening


RSS_county1_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kajiado"]-sum(cases_date_county_all_wide$KAJIADO[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KAJIADO - fit)^2)
}


RSS_county2_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nairobi City"]-sum(cases_date_county_all_wide$NAIROBI[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$NAIROBI - fit)^2)
}

RSS_county3_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kwale"]-sum(cases_date_county_all_wide$KWALE[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KWALE - fit)^2)
}

RSS_county4_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kilifi"]-sum(cases_date_county_all_wide$KILIFI[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KILIFI - fit)^2)
}
 
RSS_county5_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mombasa"]-sum(cases_date_county_all_wide$MOMBASA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$MOMBASA - fit)^2)
}

RSS_county6_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kakamega"]-sum(cases_date_county_all_wide$KAKAMEGA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KAKAMEGA - fit)^2)
}


RSS_county7_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kitui"]-sum(cases_date_county_all_wide$KITUI[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KITUI - fit)^2)
}


RSS_county8_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nakuru"]-sum(cases_date_county_all_wide$NAKURU[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$NAKURU - fit)^2)
}


RSS_county9_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mandera"]-sum(cases_date_county_all_wide$MANDERA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$MANDERA - fit)^2)
}


RSS_county10_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Uasin Gishu"]-sum(cases_date_county_all_wide$`UASIN GISHU`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`UASIN GISHU` - fit)^2)
}

RSS_county11_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Siaya"]-sum(cases_date_county_all_wide$SIAYA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$SIAYA - fit)^2)
}


RSS_county12_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Homa Bay"]-sum(cases_date_county_all_wide$`HOMA BAY`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`HOMA BAY` - fit)^2)
}

RSS_county13_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kiambu"]-sum(cases_date_county_all_wide$KIAMBU[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KIAMBU - fit)^2)
}

RSS_county14_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Wajir"]-sum(cases_date_county_all_wide$WAJIR[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$WAJIR - fit)^2)
}
 
RSS_county15_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Migori"]-sum(cases_date_county_all_wide$MIGORI[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$MIGORI - fit)^2)
}

RSS_county16_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bungoma"]-sum(cases_date_county_all_wide$BUNGOMA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$BUNGOMA - fit)^2)
}


RSS_county17_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Busia"]-sum(cases_date_county_all_wide$BUSIA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$BUSIA - fit)^2)
}


RSS_county18_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Isiolo"]-sum(cases_date_county_all_wide$ISIOLO[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$ISIOLO - fit)^2)
}


RSS_county19_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Machakos"]-sum(cases_date_county_all_wide$MACHAKOS[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$MACHAKOS - fit)^2)
}


RSS_county20_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bomet"]-sum(cases_date_county_all_wide$BOMET[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$BOMET - fit)^2)
    
}


RSS_county21_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Taita/Taveta"]-sum(cases_date_county_all_wide$`TAITA TAVETA`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`TAITA TAVETA` - fit)^2)
}


RSS_county22_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Garissa"]-sum(cases_date_county_all_wide$GARISSA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$GARISSA - fit)^2)
}

RSS_county23_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Makueni"]-sum(cases_date_county_all_wide$MAKUENI[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$MAKUENI - fit)^2)
}

RSS_county24_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisii"]-sum(cases_date_county_all_wide$KISII[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KISII - fit)^2)
}
 
RSS_county25_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Meru"]-sum(cases_date_county_all_wide$MERU[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$MERU - fit)^2)
}

RSS_county26_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kirinyaga"]-sum(cases_date_county_all_wide$KIRINYAGA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KIRINYAGA - fit)^2)
}


RSS_county27_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Trans Nzoia"]-sum(cases_date_county_all_wide$`TRANS NZOIA`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`TRANS NZOIA` - fit)^2)
}


RSS_county28_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisumu"]-sum(cases_date_county_all_wide$KISUMU[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KISUMU - fit)^2)
}


RSS_county29_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Turkana"]-sum(cases_date_county_all_wide$TURKANA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$TURKANA - fit)^2)
}


RSS_county30_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Embu"]-sum(cases_date_county_all_wide$EMBU[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$EMBU - fit)^2)
}


RSS_county31_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyeri"]-sum(cases_date_county_all_wide$NYERI[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$NYERI - fit)^2)
}


RSS_county32_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Murang'a"]-sum(cases_date_county_all_wide$`MURANG'A`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`MURANG'A` - fit)^2)
}

RSS_county33_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kericho"]-sum(cases_date_county_all_wide$KERICHO[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$KERICHO - fit)^2)
}

RSS_county34_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Laikipia"]-sum(cases_date_county_all_wide$LAIKIPIA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$LAIKIPIA - fit)^2)
}
 
RSS_county35_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nandi"]-sum(cases_date_county_all_wide$NANDI[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$NANDI - fit)^2)
}

RSS_county36_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Elgeyo/Marakwet"]-sum(cases_date_county_all_wide$`ELGEYO MARAKWET`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`ELGEYO MARAKWET` - fit)^2)
}


RSS_county37_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Marsabit"]-sum(cases_date_county_all_wide$MARSABIT[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$MARSABIT - fit)^2)
}


RSS_county38_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Narok"]-sum(cases_date_county_all_wide$NAROK[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$NAROK - fit)^2)
}


RSS_county39_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyamira"]-sum(cases_date_county_all_wide$NYAMIRA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$NYAMIRA - fit)^2)
}


RSS_county40_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Vihiga"]-sum(cases_date_county_all_wide$VIHIGA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$VIHIGA - fit)^2)
}


RSS_county41_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Lamu"]-sum(cases_date_county_all_wide$LAMU[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$LAMU - fit)^2)
}


RSS_county42_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyandarua"]-sum(cases_date_county_all_wide$NYANDARUA[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$NYANDARUA - fit)^2)
}

RSS_county43_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tharaka-Nithi"]-sum(cases_date_county_all_wide$`THARAKA NITHI`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`THARAKA NITHI` - fit)^2)
}

RSS_county44_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tana River"]-sum(cases_date_county_all_wide$`TANA RIVER`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`TANA RIVER` - fit)^2)
}
 
RSS_county45_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Baringo"]-sum(cases_date_county_all_wide$BARINGO[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$BARINGO - fit)^2)
}

RSS_county46_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "West Pokot"]-sum(cases_date_county_all_wide$`WEST POKOT`[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$`WEST POKOT` - fit)^2)
}


RSS_county47_Partiallyopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Samburu"]-sum(cases_date_county_all_wide$SAMBURU[cases_date_county_all_wide$status == "Total Lockdown"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2020/08/01"), as.Date("2020/12/31"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df3$SAMBURU - fit)^2)
}


opt_county1_Partiallyopening_beta <- optim(c(1/7), RSS_county1_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county2_Partiallyopening_beta <- optim(c(1/7), RSS_county2_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county3_Partiallyopening_beta <- optim(c(1/7), RSS_county3_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county4_Partiallyopening_beta <- optim(c(1/7), RSS_county4_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county5_Partiallyopening_beta <- optim(c(1/7), RSS_county5_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county6_Partiallyopening_beta <- optim(c(1/7), RSS_county6_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county7_Partiallyopening_beta <- optim(c(1/7), RSS_county7_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county8_Partiallyopening_beta <- optim(c(1/7), RSS_county8_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county9_Partiallyopening_beta <- optim(c(1/7), RSS_county9_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county10_Partiallyopening_beta <- optim(c(1/7), RSS_county10_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county11_Partiallyopening_beta <- optim(c(1/7), RSS_county11_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county12_Partiallyopening_beta <- optim(c(1/7), RSS_county12_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county13_Partiallyopening_beta <- optim(c(1/7), RSS_county13_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county14_Partiallyopening_beta <- optim(c(1/7), RSS_county14_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county15_Partiallyopening_beta <- optim(c(1/7), RSS_county15_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county16_Partiallyopening_beta <- optim(c(1/7), RSS_county16_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county17_Partiallyopening_beta <- optim(c(1/7), RSS_county17_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county18_Partiallyopening_beta <- optim(c(1/7), RSS_county18_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county19_Partiallyopening_beta <- optim(c(1/7), RSS_county19_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county20_Partiallyopening_beta <- optim(c(1/7), RSS_county20_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county21_Partiallyopening_beta <- optim(c(1/7), RSS_county21_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county22_Partiallyopening_beta <- optim(c(1/7), RSS_county22_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county23_Partiallyopening_beta <- optim(c(1/7), RSS_county23_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county24_Partiallyopening_beta <- optim(c(1/7), RSS_county24_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county25_Partiallyopening_beta <- optim(c(1/7), RSS_county25_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county26_Partiallyopening_beta <- optim(c(1/7), RSS_county26_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county27_Partiallyopening_beta <- optim(c(1/7), RSS_county27_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county28_Partiallyopening_beta <- optim(c(1/7), RSS_county28_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county29_Partiallyopening_beta <- optim(c(1/7), RSS_county29_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county30_Partiallyopening_beta <- optim(c(1/7), RSS_county30_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county31_Partiallyopening_beta <- optim(c(1/7), RSS_county31_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county32_Partiallyopening_beta <- optim(c(1/7), RSS_county32_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county33_Partiallyopening_beta <- optim(c(1/7), RSS_county33_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county34_Partiallyopening_beta <- optim(c(1/7), RSS_county34_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county35_Partiallyopening_beta <- optim(c(1/7), RSS_county35_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county36_Partiallyopening_beta <- optim(c(1/7), RSS_county36_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county37_Partiallyopening_beta <- optim(c(1/7), RSS_county37_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county38_Partiallyopening_beta <- optim(c(1/7), RSS_county38_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county39_Partiallyopening_beta <- optim(c(1/7), RSS_county39_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county40_Partiallyopening_beta <- optim(c(1/7), RSS_county40_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county41_Partiallyopening_beta <- optim(c(1/7), RSS_county41_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county42_Partiallyopening_beta <- optim(c(1/7), RSS_county42_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county43_Partiallyopening_beta <- optim(c(1/7), RSS_county43_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county44_Partiallyopening_beta <- optim(c(1/7), RSS_county44_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county45_Partiallyopening_beta <- optim(c(1/7), RSS_county45_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county46_Partiallyopening_beta <- optim(c(1/7), RSS_county46_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county47_Partiallyopening_beta <- optim(c(1/7), RSS_county47_Partiallyopening_beta,
                                      method = "Brent", lower = 0, upper = 1)



opt_county1_Partiallyopening_par_beta <- setNames(opt_county1_Partiallyopening_beta$par, c("beta"))

opt_county2_Partiallyopening_par_beta <- setNames(opt_county2_Partiallyopening_beta$par, c("beta"))

opt_county3_Partiallyopening_par_beta <- setNames(opt_county3_Partiallyopening_beta$par, c("beta"))

opt_county4_Partiallyopening_par_beta <- setNames(opt_county4_Partiallyopening_beta$par, c("beta"))

opt_county5_Partiallyopening_par_beta <- setNames(opt_county5_Partiallyopening_beta$par, c("beta"))

opt_county6_Partiallyopening_par_beta <- setNames(opt_county6_Partiallyopening_beta$par, c("beta"))

opt_county7_Partiallyopening_par_beta <- setNames(opt_county7_Partiallyopening_beta$par, c("beta"))

opt_county8_Partiallyopening_par_beta <- setNames(opt_county8_Partiallyopening_beta$par, c("beta"))

opt_county9_Partiallyopening_par_beta <- setNames(opt_county9_Partiallyopening_beta$par, c("beta"))

opt_county10_Partiallyopening_par_beta <- setNames(opt_county10_Partiallyopening_beta$par, c("beta"))

opt_county11_Partiallyopening_par_beta <- setNames(opt_county11_Partiallyopening_beta$par, c("beta"))

opt_county12_Partiallyopening_par_beta <- setNames(opt_county12_Partiallyopening_beta$par, c("beta"))

opt_county13_Partiallyopening_par_beta <- setNames(opt_county13_Partiallyopening_beta$par, c("beta"))

opt_county14_Partiallyopening_par_beta <- setNames(opt_county14_Partiallyopening_beta$par, c("beta"))

opt_county15_Partiallyopening_par_beta <- setNames(opt_county15_Partiallyopening_beta$par, c("beta"))

opt_county16_Partiallyopening_par_beta <- setNames(opt_county16_Partiallyopening_beta$par, c("beta"))

opt_county17_Partiallyopening_par_beta <- setNames(opt_county17_Partiallyopening_beta$par, c("beta"))

opt_county18_Partiallyopening_par_beta <- setNames(opt_county18_Partiallyopening_beta$par, c("beta"))

opt_county19_Partiallyopening_par_beta <- setNames(opt_county19_Partiallyopening_beta$par, c("beta"))

opt_county20_Partiallyopening_par_beta <- setNames(opt_county20_Partiallyopening_beta$par, c("beta"))

opt_county21_Partiallyopening_par_beta <- setNames(opt_county21_Partiallyopening_beta$par, c("beta"))

opt_county22_Partiallyopening_par_beta <- setNames(opt_county22_Partiallyopening_beta$par, c("beta"))

opt_county23_Partiallyopening_par_beta <- setNames(opt_county23_Partiallyopening_beta$par, c("beta"))

opt_county24_Partiallyopening_par_beta <- setNames(opt_county24_Partiallyopening_beta$par, c("beta"))

opt_county25_Partiallyopening_par_beta <- setNames(opt_county25_Partiallyopening_beta$par, c("beta"))

opt_county26_Partiallyopening_par_beta <- setNames(opt_county26_Partiallyopening_beta$par, c("beta"))

opt_county27_Partiallyopening_par_beta <- setNames(opt_county27_Partiallyopening_beta$par, c("beta"))

opt_county28_Partiallyopening_par_beta <- setNames(opt_county28_Partiallyopening_beta$par, c("beta"))

opt_county29_Partiallyopening_par_beta <- setNames(opt_county29_Partiallyopening_beta$par, c("beta"))

opt_county30_Partiallyopening_par_beta <- setNames(opt_county30_Partiallyopening_beta$par, c("beta"))

opt_county31_Partiallyopening_par_beta <- setNames(opt_county31_Partiallyopening_beta$par, c("beta"))

opt_county32_Partiallyopening_par_beta <- setNames(opt_county32_Partiallyopening_beta$par, c("beta"))

opt_county33_Partiallyopening_par_beta <- setNames(opt_county33_Partiallyopening_beta$par, c("beta"))

opt_county34_Partiallyopening_par_beta <- setNames(opt_county34_Partiallyopening_beta$par, c("beta"))

opt_county35_Partiallyopening_par_beta <- setNames(opt_county35_Partiallyopening_beta$par, c("beta"))

opt_county36_Partiallyopening_par_beta <- setNames(opt_county36_Partiallyopening_beta$par, c("beta"))

opt_county37_Partiallyopening_par_beta <- setNames(opt_county37_Partiallyopening_beta$par, c("beta"))

opt_county38_Partiallyopening_par_beta <- setNames(opt_county38_Partiallyopening_beta$par, c("beta"))

opt_county39_Partiallyopening_par_beta <- setNames(opt_county39_Partiallyopening_beta$par, c("beta"))

opt_county40_Partiallyopening_par_beta <- setNames(opt_county40_Partiallyopening_beta$par, c("beta"))

opt_county41_Partiallyopening_par_beta <- setNames(opt_county41_Partiallyopening_beta$par, c("beta"))

opt_county42_Partiallyopening_par_beta <- setNames(opt_county42_Partiallyopening_beta$par, c("beta"))

opt_county43_Partiallyopening_par_beta <- setNames(opt_county43_Partiallyopening_beta$par, c("beta"))

opt_county44_Partiallyopening_par_beta <- setNames(opt_county44_Partiallyopening_beta$par, c("beta"))

opt_county45_Partiallyopening_par_beta <- setNames(opt_county45_Partiallyopening_beta$par, c("beta"))

opt_county46_Partiallyopening_par_beta <- setNames(opt_county46_Partiallyopening_beta$par, c("beta"))

opt_county47_Partiallyopening_par_beta <- setNames(opt_county47_Partiallyopening_beta$par, c("beta"))


opt_county1_Partiallyopening_par_Ro <- setNames(opt_county1_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county2_Partiallyopening_par_Ro <- setNames(opt_county2_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county3_Partiallyopening_par_Ro <- setNames(opt_county3_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county4_Partiallyopening_par_Ro <- setNames(opt_county4_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county5_Partiallyopening_par_Ro <- setNames(opt_county5_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county6_Partiallyopening_par_Ro <- setNames(opt_county6_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county7_Partiallyopening_par_Ro <- setNames(opt_county7_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county8_Partiallyopening_par_Ro <- setNames(opt_county8_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county9_Partiallyopening_par_Ro <- setNames(opt_county9_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county10_Partiallyopening_par_Ro <- setNames(opt_county10_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county11_Partiallyopening_par_Ro <- setNames(opt_county11_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county12_Partiallyopening_par_Ro <- setNames(opt_county12_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county13_Partiallyopening_par_Ro <- setNames(opt_county13_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county14_Partiallyopening_par_Ro <- setNames(opt_county14_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county15_Partiallyopening_par_Ro <- setNames(opt_county15_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county16_Partiallyopening_par_Ro <- setNames(opt_county16_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county17_Partiallyopening_par_Ro <- setNames(opt_county17_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county18_Partiallyopening_par_Ro <- setNames(opt_county18_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county19_Partiallyopening_par_Ro <- setNames(opt_county19_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county20_Partiallyopening_par_Ro <- setNames(opt_county20_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county21_Partiallyopening_par_Ro <- setNames(opt_county21_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county22_Partiallyopening_par_Ro <- setNames(opt_county22_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county23_Partiallyopening_par_Ro <- setNames(opt_county23_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county24_Partiallyopening_par_Ro <- setNames(opt_county24_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county25_Partiallyopening_par_Ro <- setNames(opt_county25_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county26_Partiallyopening_par_Ro <- setNames(opt_county26_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county27_Partiallyopening_par_Ro <- setNames(opt_county27_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county28_Partiallyopening_par_Ro <- setNames(opt_county28_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county29_Partiallyopening_par_Ro <- setNames(opt_county29_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county30_Partiallyopening_par_Ro <- setNames(opt_county30_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county31_Partiallyopening_par_Ro <- setNames(opt_county31_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county32_Partiallyopening_par_Ro <- setNames(opt_county32_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county33_Partiallyopening_par_Ro <- setNames(opt_county33_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county34_Partiallyopening_par_Ro <- setNames(opt_county34_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county35_Partiallyopening_par_Ro <- setNames(opt_county35_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county36_Partiallyopening_par_Ro <- setNames(opt_county36_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county37_Partiallyopening_par_Ro <- setNames(opt_county37_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county38_Partiallyopening_par_Ro <- setNames(opt_county38_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county39_Partiallyopening_par_Ro <- setNames(opt_county39_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county40_Partiallyopening_par_Ro <- setNames(opt_county40_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county41_Partiallyopening_par_Ro <- setNames(opt_county41_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county42_Partiallyopening_par_Ro <- setNames(opt_county42_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county43_Partiallyopening_par_Ro <- setNames(opt_county43_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county44_Partiallyopening_par_Ro <- setNames(opt_county44_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county45_Partiallyopening_par_Ro <- setNames(opt_county45_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county46_Partiallyopening_par_Ro <- setNames(opt_county46_Partiallyopening_par_beta[1]/(1/14), "Ro" )

opt_county47_Partiallyopening_par_Ro <- setNames(opt_county47_Partiallyopening_par_beta[1]/(1/14), "Ro" )


```


```{r, include=FALSE}

#Reopening

RSS_county1_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kajiado"]-sum(cases_date_county_all_wide$KAJIADO[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KAJIADO - fit)^2)
}


RSS_county2_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nairobi City"]-sum(cases_date_county_all_wide$NAIROBI[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$NAIROBI - fit)^2)
}

RSS_county3_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kwale"]-sum(cases_date_county_all_wide$KWALE[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KWALE - fit)^2)
}

RSS_county4_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kilifi"]-sum(cases_date_county_all_wide$KILIFI[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KILIFI - fit)^2)
}
 
RSS_county5_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mombasa"]-sum(cases_date_county_all_wide$MOMBASA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$MOMBASA - fit)^2)
}

RSS_county6_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kakamega"]-sum(cases_date_county_all_wide$KAKAMEGA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KAKAMEGA - fit)^2)
}


RSS_county7_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kitui"]-sum(cases_date_county_all_wide$KITUI[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KITUI - fit)^2)
}


RSS_county8_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nakuru"]-sum(cases_date_county_all_wide$NAKURU[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$NAKURU - fit)^2)
}


RSS_county9_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Mandera"]-sum(cases_date_county_all_wide$MANDERA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$MANDERA - fit)^2)
}


RSS_county10_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Uasin Gishu"]-sum(cases_date_county_all_wide$`UASIN GISHU`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`UASIN GISHU` - fit)^2)
}

RSS_county11_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Siaya"]-sum(cases_date_county_all_wide$SIAYA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$SIAYA - fit)^2)
}


RSS_county12_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Homa Bay"]-sum(cases_date_county_all_wide$`HOMA BAY`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`HOMA BAY` - fit)^2)
}

RSS_county13_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kiambu"]-sum(cases_date_county_all_wide$KIAMBU[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KIAMBU - fit)^2)
}

RSS_county14_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Wajir"]-sum(cases_date_county_all_wide$WAJIR[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$WAJIR - fit)^2)
}
 
RSS_county15_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Migori"]-sum(cases_date_county_all_wide$MIGORI[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$MIGORI - fit)^2)
}

RSS_county16_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bungoma"]-sum(cases_date_county_all_wide$BUNGOMA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$BUNGOMA - fit)^2)
}


RSS_county17_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Busia"]-sum(cases_date_county_all_wide$BUSIA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$BUSIA - fit)^2)
}


RSS_county18_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Isiolo"]-sum(cases_date_county_all_wide$ISIOLO[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$ISIOLO - fit)^2)
}


RSS_county19_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Machakos"]-sum(cases_date_county_all_wide$MACHAKOS[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$MACHAKOS - fit)^2)
}


RSS_county20_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Bomet"]-sum(cases_date_county_all_wide$BOMET[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$BOMET - fit)^2)
    
}


RSS_county21_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Taita/Taveta"]-sum(cases_date_county_all_wide$`TAITA TAVETA`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`TAITA TAVETA` - fit)^2)
}


RSS_county22_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Garissa"]-sum(cases_date_county_all_wide$GARISSA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$GARISSA - fit)^2)
}

RSS_county23_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Makueni"]-sum(cases_date_county_all_wide$MAKUENI[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$MAKUENI - fit)^2)
}

RSS_county24_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisii"]-sum(cases_date_county_all_wide$KISII[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KISII - fit)^2)
}
 
RSS_county25_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Meru"]-sum(cases_date_county_all_wide$MERU[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$MERU - fit)^2)
}

RSS_county26_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kirinyaga"]-sum(cases_date_county_all_wide$KIRINYAGA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KIRINYAGA - fit)^2)
}


RSS_county27_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Trans Nzoia"]-sum(cases_date_county_all_wide$`TRANS NZOIA`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`TRANS NZOIA` - fit)^2)
}


RSS_county28_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kisumu"]-sum(cases_date_county_all_wide$KISUMU[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KISUMU - fit)^2)
}


RSS_county29_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Turkana"]-sum(cases_date_county_all_wide$TURKANA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$TURKANA - fit)^2)
}


RSS_county30_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Embu"]-sum(cases_date_county_all_wide$EMBU[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$EMBU - fit)^2)
}


RSS_county31_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyeri"]-sum(cases_date_county_all_wide$NYERI[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$NYERI - fit)^2)
}


RSS_county32_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Murang'a"]-sum(cases_date_county_all_wide$`MURANG'A`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`MURANG'A` - fit)^2)
}

RSS_county33_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Kericho"]-sum(cases_date_county_all_wide$KERICHO[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$KERICHO - fit)^2)
}

RSS_county34_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Laikipia"]-sum(cases_date_county_all_wide$LAIKIPIA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$LAIKIPIA - fit)^2)
}
 
RSS_county35_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nandi"]-sum(cases_date_county_all_wide$NANDI[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$NANDI - fit)^2)
}

RSS_county36_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Elgeyo/Marakwet"]-sum(cases_date_county_all_wide$`ELGEYO MARAKWET`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`ELGEYO MARAKWET` - fit)^2)
}


RSS_county37_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Marsabit"]-sum(cases_date_county_all_wide$MARSABIT[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$MARSABIT - fit)^2)
}


RSS_county38_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Narok"]-sum(cases_date_county_all_wide$NAROK[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$NAROK - fit)^2)
}


RSS_county39_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyamira"]-sum(cases_date_county_all_wide$NYAMIRA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$NYAMIRA - fit)^2)
}


RSS_county40_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Vihiga"]-sum(cases_date_county_all_wide$VIHIGA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$VIHIGA - fit)^2)
}


RSS_county41_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Lamu"]-sum(cases_date_county_all_wide$LAMU[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$LAMU - fit)^2)
}


RSS_county42_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Nyandarua"]-sum(cases_date_county_all_wide$NYANDARUA[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$NYANDARUA - fit)^2)
}

RSS_county43_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tharaka-Nithi"]-sum(cases_date_county_all_wide$`THARAKA NITHI`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`THARAKA NITHI` - fit)^2)
}

RSS_county44_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Tana River"]-sum(cases_date_county_all_wide$`TANA RIVER`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`TANA RIVER` - fit)^2)
}
 
RSS_county45_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Baringo"]-sum(cases_date_county_all_wide$BARINGO[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$BARINGO - fit)^2)
}

RSS_county46_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "West Pokot"]-sum(cases_date_county_all_wide$`WEST POKOT`[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$`WEST POKOT` - fit)^2)
}


RSS_county47_Reopening_beta <- function(parameters) {

    names(parameters) <- c("beta")

  initial_state_values=c(S=as.numeric(Pop_county$total[Pop_county$county == "Samburu"]-sum(cases_date_county_all_wide$SAMBURU[cases_date_county_all_wide$status == "Total Lockdown" | cases_date_county_all_wide$status == "Partially opening"]))-1,I=1,R=0)
  time=seq(from=1,
         to=length(seq(as.Date("2021/01/01"), as.Date("2021/05/15"), by=1))
         ,by=1)
  out <- ode(y = initial_state_values, times = time, func = SIR, parms = parameters)
  fit <- out[ , 3]
  
    sum((df4$SAMBURU - fit)^2)
}


opt_county1_Reopening_beta <- optim(c(1/7), RSS_county1_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county2_Reopening_beta <- optim(c(1/7), RSS_county2_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county3_Reopening_beta <- optim(c(1/7), RSS_county3_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county4_Reopening_beta <- optim(c(1/7), RSS_county4_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county5_Reopening_beta <- optim(c(1/7), RSS_county5_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county6_Reopening_beta <- optim(c(1/7), RSS_county6_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county7_Reopening_beta <- optim(c(1/7), RSS_county7_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county8_Reopening_beta <- optim(c(1/7), RSS_county8_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county9_Reopening_beta <- optim(c(1/7), RSS_county9_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county10_Reopening_beta <- optim(c(1/7), RSS_county10_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county11_Reopening_beta <- optim(c(1/7), RSS_county11_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county12_Reopening_beta <- optim(c(1/7), RSS_county12_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county13_Reopening_beta <- optim(c(1/7), RSS_county13_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county14_Reopening_beta <- optim(c(1/7), RSS_county14_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county15_Reopening_beta <- optim(c(1/7), RSS_county15_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county16_Reopening_beta <- optim(c(1/7), RSS_county16_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county17_Reopening_beta <- optim(c(1/7), RSS_county17_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county18_Reopening_beta <- optim(c(1/7), RSS_county18_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county19_Reopening_beta <- optim(c(1/7), RSS_county19_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county20_Reopening_beta <- optim(c(1/7), RSS_county20_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county21_Reopening_beta <- optim(c(1/7), RSS_county21_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county22_Reopening_beta <- optim(c(1/7), RSS_county22_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county23_Reopening_beta <- optim(c(1/7), RSS_county23_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county24_Reopening_beta <- optim(c(1/7), RSS_county24_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county25_Reopening_beta <- optim(c(1/7), RSS_county25_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county26_Reopening_beta <- optim(c(1/7), RSS_county26_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county27_Reopening_beta <- optim(c(1/7), RSS_county27_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county28_Reopening_beta <- optim(c(1/7), RSS_county28_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county29_Reopening_beta <- optim(c(1/7), RSS_county29_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county30_Reopening_beta <- optim(c(1/7), RSS_county30_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county31_Reopening_beta <- optim(c(1/7), RSS_county31_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county32_Reopening_beta <- optim(c(1/7), RSS_county32_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county33_Reopening_beta <- optim(c(1/7), RSS_county33_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county34_Reopening_beta <- optim(c(1/7), RSS_county34_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county35_Reopening_beta <- optim(c(1/7), RSS_county35_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county36_Reopening_beta <- optim(c(1/7), RSS_county36_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county37_Reopening_beta <- optim(c(1/7), RSS_county37_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county38_Reopening_beta <- optim(c(1/7), RSS_county38_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county39_Reopening_beta <- optim(c(1/7), RSS_county39_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county40_Reopening_beta <- optim(c(1/7), RSS_county40_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county41_Reopening_beta <- optim(c(1/7), RSS_county41_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county42_Reopening_beta <- optim(c(1/7), RSS_county42_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county43_Reopening_beta <- optim(c(1/7), RSS_county43_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county44_Reopening_beta <- optim(c(1/7), RSS_county44_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county45_Reopening_beta <- optim(c(1/7), RSS_county45_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county46_Reopening_beta <- optim(c(1/7), RSS_county46_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)

opt_county47_Reopening_beta <- optim(c(1/7), RSS_county47_Reopening_beta,
                                      method = "Brent", lower = 0, upper = 1)



opt_county1_Reopening_par_beta <- setNames(opt_county1_Reopening_beta$par, c("beta"))

opt_county2_Reopening_par_beta <- setNames(opt_county2_Reopening_beta$par, c("beta"))

opt_county3_Reopening_par_beta <- setNames(opt_county3_Reopening_beta$par, c("beta"))

opt_county4_Reopening_par_beta <- setNames(opt_county4_Reopening_beta$par, c("beta"))

opt_county5_Reopening_par_beta <- setNames(opt_county5_Reopening_beta$par, c("beta"))

opt_county6_Reopening_par_beta <- setNames(opt_county6_Reopening_beta$par, c("beta"))

opt_county7_Reopening_par_beta <- setNames(opt_county7_Reopening_beta$par, c("beta"))

opt_county8_Reopening_par_beta <- setNames(opt_county8_Reopening_beta$par, c("beta"))

opt_county9_Reopening_par_beta <- setNames(opt_county9_Reopening_beta$par, c("beta"))

opt_county10_Reopening_par_beta <- setNames(opt_county10_Reopening_beta$par, c("beta"))

opt_county11_Reopening_par_beta <- setNames(opt_county11_Reopening_beta$par, c("beta"))

opt_county12_Reopening_par_beta <- setNames(opt_county12_Reopening_beta$par, c("beta"))

opt_county13_Reopening_par_beta <- setNames(opt_county13_Reopening_beta$par, c("beta"))

opt_county14_Reopening_par_beta <- setNames(opt_county14_Reopening_beta$par, c("beta"))

opt_county15_Reopening_par_beta <- setNames(opt_county15_Reopening_beta$par, c("beta"))

opt_county16_Reopening_par_beta <- setNames(opt_county16_Reopening_beta$par, c("beta"))

opt_county17_Reopening_par_beta <- setNames(opt_county17_Reopening_beta$par, c("beta"))

opt_county18_Reopening_par_beta <- setNames(opt_county18_Reopening_beta$par, c("beta"))

opt_county19_Reopening_par_beta <- setNames(opt_county19_Reopening_beta$par, c("beta"))

opt_county20_Reopening_par_beta <- setNames(opt_county20_Reopening_beta$par, c("beta"))

opt_county21_Reopening_par_beta <- setNames(opt_county21_Reopening_beta$par, c("beta"))

opt_county22_Reopening_par_beta <- setNames(opt_county22_Reopening_beta$par, c("beta"))

opt_county23_Reopening_par_beta <- setNames(opt_county23_Reopening_beta$par, c("beta"))

opt_county24_Reopening_par_beta <- setNames(opt_county24_Reopening_beta$par, c("beta"))

opt_county25_Reopening_par_beta <- setNames(opt_county25_Reopening_beta$par, c("beta"))

opt_county26_Reopening_par_beta <- setNames(opt_county26_Reopening_beta$par, c("beta"))

opt_county27_Reopening_par_beta <- setNames(opt_county27_Reopening_beta$par, c("beta"))

opt_county28_Reopening_par_beta <- setNames(opt_county28_Reopening_beta$par, c("beta"))

opt_county29_Reopening_par_beta <- setNames(opt_county29_Reopening_beta$par, c("beta"))

opt_county30_Reopening_par_beta <- setNames(opt_county30_Reopening_beta$par, c("beta"))

opt_county31_Reopening_par_beta <- setNames(opt_county31_Reopening_beta$par, c("beta"))

opt_county32_Reopening_par_beta <- setNames(opt_county32_Reopening_beta$par, c("beta"))

opt_county33_Reopening_par_beta <- setNames(opt_county33_Reopening_beta$par, c("beta"))

opt_county34_Reopening_par_beta <- setNames(opt_county34_Reopening_beta$par, c("beta"))

opt_county35_Reopening_par_beta <- setNames(opt_county35_Reopening_beta$par, c("beta"))

opt_county36_Reopening_par_beta <- setNames(opt_county36_Reopening_beta$par, c("beta"))

opt_county37_Reopening_par_beta <- setNames(opt_county37_Reopening_beta$par, c("beta"))

opt_county38_Reopening_par_beta <- setNames(opt_county38_Reopening_beta$par, c("beta"))

opt_county39_Reopening_par_beta <- setNames(opt_county39_Reopening_beta$par, c("beta"))

opt_county40_Reopening_par_beta <- setNames(opt_county40_Reopening_beta$par, c("beta"))

opt_county41_Reopening_par_beta <- setNames(opt_county41_Reopening_beta$par, c("beta"))

opt_county42_Reopening_par_beta <- setNames(opt_county42_Reopening_beta$par, c("beta"))

opt_county43_Reopening_par_beta <- setNames(opt_county43_Reopening_beta$par, c("beta"))

opt_county44_Reopening_par_beta <- setNames(opt_county44_Reopening_beta$par, c("beta"))

opt_county45_Reopening_par_beta <- setNames(opt_county45_Reopening_beta$par, c("beta"))

opt_county46_Reopening_par_beta <- setNames(opt_county46_Reopening_beta$par, c("beta"))

opt_county47_Reopening_par_beta <- setNames(opt_county47_Reopening_beta$par, c("beta"))


opt_county1_Reopening_par_Ro <- setNames(opt_county1_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county2_Reopening_par_Ro <- setNames(opt_county2_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county3_Reopening_par_Ro <- setNames(opt_county3_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county4_Reopening_par_Ro <- setNames(opt_county4_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county5_Reopening_par_Ro <- setNames(opt_county5_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county6_Reopening_par_Ro <- setNames(opt_county6_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county7_Reopening_par_Ro <- setNames(opt_county7_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county8_Reopening_par_Ro <- setNames(opt_county8_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county9_Reopening_par_Ro <- setNames(opt_county9_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county10_Reopening_par_Ro <- setNames(opt_county10_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county11_Reopening_par_Ro <- setNames(opt_county11_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county12_Reopening_par_Ro <- setNames(opt_county12_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county13_Reopening_par_Ro <- setNames(opt_county13_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county14_Reopening_par_Ro <- setNames(opt_county14_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county15_Reopening_par_Ro <- setNames(opt_county15_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county16_Reopening_par_Ro <- setNames(opt_county16_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county17_Reopening_par_Ro <- setNames(opt_county17_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county18_Reopening_par_Ro <- setNames(opt_county18_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county19_Reopening_par_Ro <- setNames(opt_county19_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county20_Reopening_par_Ro <- setNames(opt_county20_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county21_Reopening_par_Ro <- setNames(opt_county21_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county22_Reopening_par_Ro <- setNames(opt_county22_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county23_Reopening_par_Ro <- setNames(opt_county23_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county24_Reopening_par_Ro <- setNames(opt_county24_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county25_Reopening_par_Ro <- setNames(opt_county25_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county26_Reopening_par_Ro <- setNames(opt_county26_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county27_Reopening_par_Ro <- setNames(opt_county27_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county28_Reopening_par_Ro <- setNames(opt_county28_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county29_Reopening_par_Ro <- setNames(opt_county29_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county30_Reopening_par_Ro <- setNames(opt_county30_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county31_Reopening_par_Ro <- setNames(opt_county31_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county32_Reopening_par_Ro <- setNames(opt_county32_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county33_Reopening_par_Ro <- setNames(opt_county33_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county34_Reopening_par_Ro <- setNames(opt_county34_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county35_Reopening_par_Ro <- setNames(opt_county35_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county36_Reopening_par_Ro <- setNames(opt_county36_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county37_Reopening_par_Ro <- setNames(opt_county37_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county38_Reopening_par_Ro <- setNames(opt_county38_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county39_Reopening_par_Ro <- setNames(opt_county39_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county40_Reopening_par_Ro <- setNames(opt_county40_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county41_Reopening_par_Ro <- setNames(opt_county41_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county42_Reopening_par_Ro <- setNames(opt_county42_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county43_Reopening_par_Ro <- setNames(opt_county43_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county44_Reopening_par_Ro <- setNames(opt_county44_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county45_Reopening_par_Ro <- setNames(opt_county45_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county46_Reopening_par_Ro <- setNames(opt_county46_Reopening_par_beta[1]/(1/14), "Ro" )

opt_county47_Reopening_par_Ro <- setNames(opt_county47_Reopening_par_beta[1]/(1/14), "Ro" )


```


```{r}


optim1_par_county_output <- tibble( optim1_par_county_all_ages = rep(c("Beginning Mar20", "12Mar20-15May21", "Total Lockdown", "Partially opening", "Reopening" ), each = 47, times = 1 ),
        county = rep(c(unique(counties$county_where_the_case_was_diagonised)), times = 5), 
        Ro = c(opt_county1_Beginning_par_Ro, opt_county2_Beginning_par_Ro, opt_county3_Beginning_par_Ro, opt_county4_Beginning_par_Ro, opt_county5_Beginning_par_Ro, opt_county6_Beginning_par_Ro, opt_county7_Beginning_par_Ro, opt_county8_Beginning_par_Ro, opt_county9_Beginning_par_Ro, opt_county10_Beginning_par_Ro, opt_county11_Beginning_par_Ro, opt_county12_Beginning_par_Ro, opt_county13_Beginning_par_Ro, opt_county14_Beginning_par_Ro, opt_county15_Beginning_par_Ro, opt_county16_Beginning_par_Ro, opt_county17_Beginning_par_Ro, opt_county18_Beginning_par_Ro, opt_county19_Beginning_par_Ro, opt_county20_Beginning_par_Ro, opt_county21_Beginning_par_Ro, opt_county22_Beginning_par_Ro, opt_county23_Beginning_par_Ro, opt_county24_Beginning_par_Ro, opt_county25_Beginning_par_Ro, opt_county26_Beginning_par_Ro, opt_county27_Beginning_par_Ro, opt_county28_Beginning_par_Ro, opt_county29_Beginning_par_Ro, opt_county30_Beginning_par_Ro, opt_county31_Beginning_par_Ro, opt_county32_Beginning_par_Ro, opt_county33_Beginning_par_Ro, opt_county34_Beginning_par_Ro, opt_county35_Beginning_par_Ro, opt_county36_Beginning_par_Ro, opt_county37_Beginning_par_Ro, opt_county38_Beginning_par_Ro, opt_county39_Beginning_par_Ro, opt_county40_Beginning_par_Ro, opt_county41_Beginning_par_Ro, opt_county42_Beginning_par_Ro, opt_county43_Beginning_par_Ro, opt_county44_Beginning_par_Ro, opt_county45_Beginning_par_Ro, opt_county46_Beginning_par_Ro, opt_county47_Beginning_par_Ro, opt_county1_Mar20_May21_par_Ro, opt_county2_Mar20_May21_par_Ro, opt_county3_Mar20_May21_par_Ro, opt_county4_Mar20_May21_par_Ro, opt_county5_Mar20_May21_par_Ro, opt_county6_Mar20_May21_par_Ro, opt_county7_Mar20_May21_par_Ro, opt_county8_Mar20_May21_par_Ro, opt_county9_Mar20_May21_par_Ro, opt_county10_Mar20_May21_par_Ro, opt_county11_Mar20_May21_par_Ro, opt_county12_Mar20_May21_par_Ro, opt_county13_Mar20_May21_par_Ro, opt_county14_Mar20_May21_par_Ro, opt_county15_Mar20_May21_par_Ro, opt_county16_Mar20_May21_par_Ro, opt_county17_Mar20_May21_par_Ro, opt_county18_Mar20_May21_par_Ro, opt_county19_Mar20_May21_par_Ro, opt_county20_Mar20_May21_par_Ro, opt_county21_Mar20_May21_par_Ro, opt_county22_Mar20_May21_par_Ro, opt_county23_Mar20_May21_par_Ro, opt_county24_Mar20_May21_par_Ro, opt_county25_Mar20_May21_par_Ro, opt_county26_Mar20_May21_par_Ro, opt_county27_Mar20_May21_par_Ro, opt_county28_Mar20_May21_par_Ro, opt_county29_Mar20_May21_par_Ro, opt_county30_Mar20_May21_par_Ro, opt_county31_Mar20_May21_par_Ro, opt_county32_Mar20_May21_par_Ro, opt_county33_Mar20_May21_par_Ro, opt_county34_Mar20_May21_par_Ro, opt_county35_Mar20_May21_par_Ro, opt_county36_Mar20_May21_par_Ro, opt_county37_Mar20_May21_par_Ro, opt_county38_Mar20_May21_par_Ro, opt_county39_Mar20_May21_par_Ro, opt_county40_Mar20_May21_par_Ro, opt_county41_Mar20_May21_par_Ro, opt_county42_Mar20_May21_par_Ro, opt_county43_Mar20_May21_par_Ro, opt_county44_Mar20_May21_par_Ro, opt_county45_Mar20_May21_par_Ro, opt_county46_Mar20_May21_par_Ro, opt_county47_Mar20_May21_par_Ro, opt_county1_TotalLockdown_par_Ro, opt_county2_TotalLockdown_par_Ro, opt_county3_TotalLockdown_par_Ro, opt_county4_TotalLockdown_par_Ro, opt_county5_TotalLockdown_par_Ro, opt_county6_TotalLockdown_par_Ro, opt_county7_TotalLockdown_par_Ro, opt_county8_TotalLockdown_par_Ro, opt_county9_TotalLockdown_par_Ro, opt_county10_TotalLockdown_par_Ro, opt_county11_TotalLockdown_par_Ro, opt_county12_TotalLockdown_par_Ro, opt_county13_TotalLockdown_par_Ro, opt_county14_TotalLockdown_par_Ro, opt_county15_TotalLockdown_par_Ro, opt_county16_TotalLockdown_par_Ro, opt_county17_TotalLockdown_par_Ro, opt_county18_TotalLockdown_par_Ro, opt_county19_TotalLockdown_par_Ro, opt_county20_TotalLockdown_par_Ro, opt_county21_TotalLockdown_par_Ro, opt_county22_TotalLockdown_par_Ro, opt_county23_TotalLockdown_par_Ro, opt_county24_TotalLockdown_par_Ro, opt_county25_TotalLockdown_par_Ro, opt_county26_TotalLockdown_par_Ro,
opt_county27_TotalLockdown_par_Ro, opt_county28_TotalLockdown_par_Ro, opt_county29_TotalLockdown_par_Ro,
opt_county30_TotalLockdown_par_Ro, opt_county31_TotalLockdown_par_Ro, opt_county32_TotalLockdown_par_Ro, opt_county33_TotalLockdown_par_Ro, opt_county34_TotalLockdown_par_Ro, opt_county35_TotalLockdown_par_Ro, opt_county36_TotalLockdown_par_Ro, opt_county37_TotalLockdown_par_Ro, opt_county38_TotalLockdown_par_Ro, opt_county39_TotalLockdown_par_Ro, opt_county40_TotalLockdown_par_Ro, opt_county41_TotalLockdown_par_Ro, opt_county42_TotalLockdown_par_Ro, opt_county43_TotalLockdown_par_Ro, opt_county44_TotalLockdown_par_Ro, opt_county45_TotalLockdown_par_Ro, opt_county46_TotalLockdown_par_Ro, opt_county47_TotalLockdown_par_Ro, opt_county1_Partiallyopening_par_Ro, opt_county2_Partiallyopening_par_Ro, opt_county3_Partiallyopening_par_Ro, opt_county4_Partiallyopening_par_Ro, opt_county5_Partiallyopening_par_Ro, opt_county6_Partiallyopening_par_Ro, opt_county7_Partiallyopening_par_Ro, opt_county8_Partiallyopening_par_Ro, opt_county9_Partiallyopening_par_Ro, opt_county10_Partiallyopening_par_Ro, opt_county11_Partiallyopening_par_Ro, opt_county12_Partiallyopening_par_Ro, opt_county13_Partiallyopening_par_Ro, opt_county14_Partiallyopening_par_Ro, opt_county15_Partiallyopening_par_Ro, opt_county16_Partiallyopening_par_Ro, opt_county17_Partiallyopening_par_Ro, opt_county18_Partiallyopening_par_Ro, opt_county19_Partiallyopening_par_Ro, opt_county20_Partiallyopening_par_Ro, opt_county21_Partiallyopening_par_Ro, opt_county22_Partiallyopening_par_Ro, opt_county23_Partiallyopening_par_Ro, opt_county24_Partiallyopening_par_Ro, opt_county25_Partiallyopening_par_Ro, opt_county26_Partiallyopening_par_Ro, opt_county27_Partiallyopening_par_Ro, opt_county28_Partiallyopening_par_Ro, opt_county29_Partiallyopening_par_Ro, opt_county30_Partiallyopening_par_Ro, opt_county31_Partiallyopening_par_Ro, opt_county32_Partiallyopening_par_Ro, opt_county33_Partiallyopening_par_Ro, opt_county34_Partiallyopening_par_Ro, opt_county35_Partiallyopening_par_Ro, opt_county36_Partiallyopening_par_Ro, opt_county37_Partiallyopening_par_Ro, opt_county38_Partiallyopening_par_Ro, opt_county39_Partiallyopening_par_Ro, opt_county40_Partiallyopening_par_Ro, opt_county41_Partiallyopening_par_Ro, opt_county42_Partiallyopening_par_Ro, opt_county43_Partiallyopening_par_Ro, opt_county44_Partiallyopening_par_Ro, opt_county45_Partiallyopening_par_Ro, opt_county46_Partiallyopening_par_Ro,
opt_county47_Partiallyopening_par_Ro, opt_county1_Reopening_par_Ro, opt_county2_Reopening_par_Ro, opt_county3_Reopening_par_Ro, opt_county4_Reopening_par_Ro, opt_county5_Reopening_par_Ro, opt_county6_Reopening_par_Ro, opt_county7_Reopening_par_Ro, opt_county8_Reopening_par_Ro, opt_county9_Reopening_par_Ro, opt_county10_Reopening_par_Ro, opt_county11_Reopening_par_Ro, opt_county12_Reopening_par_Ro, opt_county13_Reopening_par_Ro, opt_county14_Reopening_par_Ro, opt_county15_Reopening_par_Ro, opt_county16_Reopening_par_Ro, opt_county17_Reopening_par_Ro, opt_county18_Reopening_par_Ro, opt_county19_Reopening_par_Ro, opt_county20_Reopening_par_Ro, opt_county21_Reopening_par_Ro, opt_county22_Reopening_par_Ro, opt_county23_Reopening_par_Ro, opt_county24_Reopening_par_Ro, opt_county25_Reopening_par_Ro, opt_county26_Reopening_par_Ro, opt_county27_Reopening_par_Ro, opt_county28_Reopening_par_Ro, opt_county29_Reopening_par_Ro, opt_county30_Reopening_par_Ro, opt_county31_Reopening_par_Ro, opt_county32_Reopening_par_Ro, opt_county33_Reopening_par_Ro, opt_county34_Reopening_par_Ro, opt_county35_Reopening_par_Ro, opt_county36_Reopening_par_Ro, opt_county37_Reopening_par_Ro, opt_county38_Reopening_par_Ro, opt_county39_Reopening_par_Ro, opt_county40_Reopening_par_Ro, opt_county41_Reopening_par_Ro, opt_county42_Reopening_par_Ro, opt_county43_Reopening_par_Ro, opt_county44_Reopening_par_Ro, opt_county45_Reopening_par_Ro, opt_county46_Reopening_par_Ro, opt_county47_Reopening_par_Ro

),
infection_rate_Beta = c(opt_county1_Beginning_par_beta, opt_county2_Beginning_par_beta, opt_county3_Beginning_par_beta, opt_county4_Beginning_par_beta, opt_county5_Beginning_par_beta, opt_county6_Beginning_par_beta, opt_county7_Beginning_par_beta, opt_county8_Beginning_par_beta, opt_county9_Beginning_par_beta, opt_county10_Beginning_par_beta, opt_county11_Beginning_par_beta, opt_county12_Beginning_par_beta, opt_county13_Beginning_par_beta, opt_county14_Beginning_par_beta, opt_county15_Beginning_par_beta, opt_county16_Beginning_par_beta, opt_county17_Beginning_par_beta, opt_county18_Beginning_par_beta, opt_county19_Beginning_par_beta, opt_county20_Beginning_par_beta, opt_county21_Beginning_par_beta, opt_county22_Beginning_par_beta, opt_county23_Beginning_par_beta, opt_county24_Beginning_par_beta, opt_county25_Beginning_par_beta, opt_county26_Beginning_par_beta, opt_county27_Beginning_par_beta, opt_county28_Beginning_par_beta, opt_county29_Beginning_par_beta, opt_county30_Beginning_par_beta, opt_county31_Beginning_par_beta, opt_county32_Beginning_par_beta, opt_county33_Beginning_par_beta, opt_county34_Beginning_par_beta, opt_county35_Beginning_par_beta, opt_county36_Beginning_par_beta, opt_county37_Beginning_par_beta, opt_county38_Beginning_par_beta, opt_county39_Beginning_par_beta, opt_county40_Beginning_par_beta, opt_county41_Beginning_par_beta, opt_county42_Beginning_par_beta, opt_county43_Beginning_par_beta, opt_county44_Beginning_par_beta, opt_county45_Beginning_par_beta, opt_county46_Beginning_par_beta, opt_county47_Beginning_par_beta, opt_county1_Mar20_May21_par_beta, opt_county2_Mar20_May21_par_beta, opt_county3_Mar20_May21_par_beta, opt_county4_Mar20_May21_par_beta, opt_county5_Mar20_May21_par_beta, opt_county6_Mar20_May21_par_beta, opt_county7_Mar20_May21_par_beta, opt_county8_Mar20_May21_par_beta, opt_county9_Mar20_May21_par_beta, opt_county10_Mar20_May21_par_beta, opt_county11_Mar20_May21_par_beta, opt_county12_Mar20_May21_par_beta, opt_county13_Mar20_May21_par_beta, opt_county14_Mar20_May21_par_beta, opt_county15_Mar20_May21_par_beta, opt_county16_Mar20_May21_par_beta, opt_county17_Mar20_May21_par_beta, opt_county18_Mar20_May21_par_beta, opt_county19_Mar20_May21_par_beta, opt_county20_Mar20_May21_par_beta, opt_county21_Mar20_May21_par_beta, opt_county22_Mar20_May21_par_beta, opt_county23_Mar20_May21_par_beta, opt_county24_Mar20_May21_par_beta, opt_county25_Mar20_May21_par_beta, opt_county26_Mar20_May21_par_beta, opt_county27_Mar20_May21_par_beta, opt_county28_Mar20_May21_par_beta, opt_county29_Mar20_May21_par_beta, opt_county30_Mar20_May21_par_beta, opt_county31_Mar20_May21_par_beta, opt_county32_Mar20_May21_par_beta, opt_county33_Mar20_May21_par_beta, opt_county34_Mar20_May21_par_beta, opt_county35_Mar20_May21_par_beta, opt_county36_Mar20_May21_par_beta, opt_county37_Mar20_May21_par_beta, opt_county38_Mar20_May21_par_beta, opt_county39_Mar20_May21_par_beta, opt_county40_Mar20_May21_par_beta, opt_county41_Mar20_May21_par_beta, opt_county42_Mar20_May21_par_beta, opt_county43_Mar20_May21_par_beta, opt_county44_Mar20_May21_par_beta, opt_county45_Mar20_May21_par_beta, opt_county46_Mar20_May21_par_beta, opt_county47_Mar20_May21_par_beta,
opt_county1_TotalLockdown_par_beta, opt_county2_TotalLockdown_par_beta, opt_county3_TotalLockdown_par_beta, opt_county4_TotalLockdown_par_beta, opt_county5_TotalLockdown_par_beta, opt_county6_TotalLockdown_par_beta, opt_county7_TotalLockdown_par_beta, opt_county8_TotalLockdown_par_beta, opt_county9_TotalLockdown_par_beta, opt_county10_TotalLockdown_par_beta, opt_county11_TotalLockdown_par_beta, opt_county12_TotalLockdown_par_beta, opt_county13_TotalLockdown_par_beta, opt_county14_TotalLockdown_par_beta, opt_county15_TotalLockdown_par_beta, opt_county16_TotalLockdown_par_beta, opt_county17_TotalLockdown_par_beta, opt_county18_TotalLockdown_par_beta, opt_county19_TotalLockdown_par_beta, opt_county20_TotalLockdown_par_beta, opt_county21_TotalLockdown_par_beta, opt_county22_TotalLockdown_par_beta, opt_county23_TotalLockdown_par_beta, opt_county24_TotalLockdown_par_beta, opt_county25_TotalLockdown_par_beta, opt_county26_TotalLockdown_par_beta, opt_county27_TotalLockdown_par_beta, opt_county28_TotalLockdown_par_beta, opt_county29_TotalLockdown_par_beta, opt_county30_TotalLockdown_par_beta, opt_county31_TotalLockdown_par_beta, opt_county32_TotalLockdown_par_beta, opt_county33_TotalLockdown_par_beta, opt_county34_TotalLockdown_par_beta, opt_county35_TotalLockdown_par_beta, opt_county36_TotalLockdown_par_beta, opt_county37_TotalLockdown_par_beta, opt_county38_TotalLockdown_par_beta, opt_county39_TotalLockdown_par_beta, opt_county40_TotalLockdown_par_beta, opt_county41_TotalLockdown_par_beta, opt_county42_TotalLockdown_par_beta, opt_county43_TotalLockdown_par_beta, opt_county44_TotalLockdown_par_beta, opt_county45_TotalLockdown_par_beta, opt_county46_TotalLockdown_par_beta, opt_county47_TotalLockdown_par_beta, opt_county1_Partiallyopening_par_beta, opt_county2_Partiallyopening_par_beta, opt_county3_Partiallyopening_par_beta, opt_county4_Partiallyopening_par_beta, opt_county5_Partiallyopening_par_beta, opt_county6_Partiallyopening_par_beta, opt_county7_Partiallyopening_par_beta, opt_county8_Partiallyopening_par_beta, opt_county9_Partiallyopening_par_beta,
opt_county10_Partiallyopening_par_beta, opt_county11_Partiallyopening_par_beta, opt_county12_Partiallyopening_par_beta, opt_county13_Partiallyopening_par_beta, opt_county14_Partiallyopening_par_beta, opt_county15_Partiallyopening_par_beta, opt_county16_Partiallyopening_par_beta, opt_county17_Partiallyopening_par_beta, opt_county18_Partiallyopening_par_beta, opt_county19_Partiallyopening_par_beta, opt_county20_Partiallyopening_par_beta, opt_county21_Partiallyopening_par_beta, opt_county22_Partiallyopening_par_beta, opt_county23_Partiallyopening_par_beta, opt_county24_Partiallyopening_par_beta, opt_county25_Partiallyopening_par_beta, opt_county26_Partiallyopening_par_beta, opt_county27_Partiallyopening_par_beta, opt_county28_Partiallyopening_par_beta, opt_county29_Partiallyopening_par_beta, opt_county30_Partiallyopening_par_beta, opt_county31_Partiallyopening_par_beta, opt_county32_Partiallyopening_par_beta, opt_county33_Partiallyopening_par_beta, opt_county34_Partiallyopening_par_beta, opt_county35_Partiallyopening_par_beta, opt_county36_Partiallyopening_par_beta, opt_county37_Partiallyopening_par_beta, opt_county38_Partiallyopening_par_beta, opt_county39_Partiallyopening_par_beta, opt_county40_Partiallyopening_par_beta, opt_county41_Partiallyopening_par_beta, opt_county42_Partiallyopening_par_beta, opt_county43_Partiallyopening_par_beta, opt_county44_Partiallyopening_par_beta, opt_county45_Partiallyopening_par_beta, opt_county46_Partiallyopening_par_beta, opt_county47_Partiallyopening_par_beta,
opt_county1_Reopening_par_beta, opt_county2_Reopening_par_beta, opt_county3_Reopening_par_beta, opt_county4_Reopening_par_beta, opt_county5_Reopening_par_beta, opt_county6_Reopening_par_beta, opt_county7_Reopening_par_beta, opt_county8_Reopening_par_beta, opt_county9_Reopening_par_beta, opt_county10_Reopening_par_beta, opt_county11_Reopening_par_beta, opt_county12_Reopening_par_beta, opt_county13_Reopening_par_beta, opt_county14_Reopening_par_beta, opt_county15_Reopening_par_beta, opt_county16_Reopening_par_beta, opt_county17_Reopening_par_beta, opt_county18_Reopening_par_beta, opt_county19_Reopening_par_beta, opt_county20_Reopening_par_beta, opt_county21_Reopening_par_beta, opt_county22_Reopening_par_beta, opt_county23_Reopening_par_beta, opt_county24_Reopening_par_beta, opt_county25_Reopening_par_beta, opt_county26_Reopening_par_beta, opt_county27_Reopening_par_beta, opt_county28_Reopening_par_beta, opt_county29_Reopening_par_beta, opt_county30_Reopening_par_beta, opt_county31_Reopening_par_beta, opt_county32_Reopening_par_beta, opt_county33_Reopening_par_beta, opt_county34_Reopening_par_beta, opt_county35_Reopening_par_beta, opt_county36_Reopening_par_beta, opt_county37_Reopening_par_beta, opt_county38_Reopening_par_beta, opt_county39_Reopening_par_beta, opt_county40_Reopening_par_beta, opt_county41_Reopening_par_beta, opt_county42_Reopening_par_beta, opt_county43_Reopening_par_beta, opt_county44_Reopening_par_beta, opt_county45_Reopening_par_beta, opt_county46_Reopening_par_beta, opt_county47_Reopening_par_beta
),  recovery_rate_gamma = round( c(rep(1/14, 235)),5)
                                    
)

kable(optim1_par_county_output)


```

```{r}
#write_excel_csv(optim1_par_county_output, "optim1_par_county_output_allages.csv")

```












